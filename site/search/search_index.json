{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Scraping Coto Documentation","text":"<p>Welcome to the Scraping Coto documentation! This project implements a data pipeline for scraping and processing data from Coto using Databricks and the Medallion Architecture.</p>"},{"location":"#overview","title":"Overview","text":"<p>This project scrapes product data from Coto's website and processes it through a three-tier medallion architecture:</p> <ul> <li>Bronze Layer: Raw data ingestion from staging volumes</li> <li>Silver Layer: Cleaned and transformed data  </li> <li>Gold Layer: Business-ready aggregated data</li> </ul>"},{"location":"#features","title":"Features","text":"<ul> <li>\u2705 Automated data scraping from Coto</li> <li>\u2705 Medallion architecture (Bronze, Silver, Gold)</li> <li>\u2705 Databricks Asset Bundles for deployment</li> <li>\u2705 Unity Catalog for data governance</li> <li>\u2705 Delta Lake for ACID transactions</li> <li>\u2705 Auto Loader for incremental data ingestion</li> <li>\u2705 Streaming transformations</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#installation","title":"Installation","text":"<pre><code># Clone the repository\ngit clone https://github.com/yourusername/scraping_coto.git\ncd scraping_coto\n\n# Install dependencies\nuv sync\n\n# Deploy to Databricks\ndatabricks bundle deploy -t dev\n</code></pre>"},{"location":"#project-structure","title":"Project Structure","text":"<pre><code>scraping_coto/\n\u251c\u2500\u2500 src/scraping_coto/\n\u2502   \u251c\u2500\u2500 etl/\n\u2502   \u2502   \u251c\u2500\u2500 staging/     # Data extraction\n\u2502   \u2502   \u251c\u2500\u2500 bronze/      # Raw data ingestion\n\u2502   \u2502   \u251c\u2500\u2500 silver/      # Data transformation\n\u2502   \u2502   \u2514\u2500\u2500 gold/        # Business aggregations\n\u2502   \u2514\u2500\u2500 utils/           # Shared utilities\n\u251c\u2500\u2500 resources/           # Databricks job definitions\n\u2514\u2500\u2500 docs/               # Documentation\n</code></pre>"},{"location":"#architecture","title":"Architecture","text":"<p>The pipeline follows the Medallion Architecture:</p> <pre><code>graph LR\n    A[Web Scraping] --&gt; B[Staging Volume]\n    B --&gt; C[Bronze Tables]\n    C --&gt; D[Silver Tables]\n    D --&gt; E[Gold Tables]\n</code></pre>"},{"location":"#navigation","title":"Navigation","text":"<ul> <li>Code Reference - Auto-generated API documentation</li> <li>ETL Pipeline - Data pipeline modules</li> <li>Utilities - Helper functions</li> </ul>"},{"location":"#contributing","title":"Contributing","text":"<p>Contributions are welcome! Please read our contributing guidelines before submitting PRs.</p>"},{"location":"#license","title":"License","text":"<p>This project is licensed under the MIT License.</p>"},{"location":"reference/SUMMARY/","title":"SUMMARY","text":"<ul> <li>scraping_coto<ul> <li>etl<ul> <li>bronze<ul> <li>staging_to_bronze</li> </ul> </li> <li>gold<ul> <li>silver_to_gold</li> </ul> </li> <li>silver<ul> <li>bronze_to_silver</li> <li>schemas<ul> <li>categories</li> <li>departments</li> <li>items</li> </ul> </li> <li>transformations<ul> <li>categories</li> <li>departments</li> <li>items</li> <li>subcategories</li> <li>utils<ul> <li>converters</li> </ul> </li> </ul> </li> </ul> </li> <li>staging<ul> <li>extract_urls</li> </ul> </li> </ul> </li> <li>utils<ul> <li>dbutils</li> <li>json</li> <li>literals</li> <li>logger</li> <li>retry</li> <li>spark_session</li> </ul> </li> </ul> </li> </ul>"},{"location":"reference/scraping_coto/etl/bronze/staging_to_bronze/","title":"staging_to_bronze","text":""},{"location":"reference/scraping_coto/etl/bronze/staging_to_bronze/#scraping_coto.etl.bronze.staging_to_bronze","title":"scraping_coto.etl.bronze.staging_to_bronze","text":""},{"location":"reference/scraping_coto/etl/bronze/staging_to_bronze/#scraping_coto.etl.bronze.staging_to_bronze-classes","title":"Classes","text":""},{"location":"reference/scraping_coto/etl/bronze/staging_to_bronze/#scraping_coto.etl.bronze.staging_to_bronze-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/etl/bronze/staging_to_bronze/#scraping_coto.etl.bronze.staging_to_bronze.load_to_bronze","title":"load_to_bronze  <code>async</code>","text":"<pre><code>load_to_bronze(spark: SparkSession, type: URLTYPE = 'department', catalog: str = 'main', schema: str = 'default', table: str = 'test')\n</code></pre> <p>Load data from CotoScraper into a Bronze table in the specified catalog, schema, and table. Args:     spark (SparkSession): Active Spark session.     type (URLTYPE): Type of URL to load ('department', 'category', or 'subcategory').     catalog (str): Target catalog.     schema (str): Target schema.     table (str): Target table name. Returns:     None Example:     &gt;&gt;&gt; await load_to_bronze(spark, type='department', catalog='main', schema='default', table='departments')</p> Source code in <code>src\\scraping_coto\\etl\\bronze\\staging_to_bronze.py</code> <pre><code>async def load_to_bronze(spark: SparkSession, type: URLTYPE = 'department', catalog: str = 'main', schema: str = 'default', table: str = 'test'):\n    \"\"\" \n        Load data from CotoScraper into a Bronze table in the specified catalog, schema, and table.\n        Args:\n            spark (SparkSession): Active Spark session.\n            type (URLTYPE): Type of URL to load ('department', 'category', or 'subcategory').\n            catalog (str): Target catalog.\n            schema (str): Target schema.\n            table (str): Target table name.\n        Returns:\n            None\n        Example:\n            &gt;&gt;&gt; await load_to_bronze(spark, type='department', catalog='main', schema='default', table='departments')\n    \"\"\"\n    if type not in ['department','category','subcategory']:\n        return 'Error: type must be department, category or subcategory'\n\n    elif type == 'department':\n        scraper = CotoScraper()\n        data = scraper.parse_base_json()\n        df = spark.createDataFrame(data)\n        try:\n            (\n                df\n                .write\n                .mode(\"append\")\n                .option(\"mergeSchema\", \"true\")\n                .saveAsTable(f\"{catalog}.{schema}.{table}\")\n            )\n        except:\n            (\n                df\n                .write\n                .mode(\"overwrite\")\n                .option(\"mergeSchema\", \"true\")\n                .saveAsTable(f\"{catalog}.{schema}.{table}\")\n            )\n\n    else:\n        scraper = CotoScraperTotalItems()\n        data = await scraper.parse_item_json(prefix=type)\n        df = spark.createDataFrame(data)\n        try:\n            (\n                df\n                .write\n                .mode(\"append\")\n                .option(\"mergeSchema\", \"true\")\n                .saveAsTable(f\"{catalog}.{schema}.{table}\")\n            )\n        except:\n            (\n                df\n                .write\n                .mode(\"overwrite\")\n                .option(\"mergeSchema\", \"true\")\n                .saveAsTable(f\"{catalog}.{schema}.{table}\")\n            )\n</code></pre>"},{"location":"reference/scraping_coto/etl/bronze/staging_to_bronze/#scraping_coto.etl.bronze.staging_to_bronze.volumes_to_bronze","title":"volumes_to_bronze","text":"<pre><code>volumes_to_bronze(spark: SparkSession, type: FOLDERTYPE = 'departments', catalog: str = 'main', schema: str = 'default', table: str = 'test', volume: str = 'staging', file_format: str = 'json', mode: str = 'append')\n</code></pre> <p>Load raw files from a Unity Catalog volume and save them into a Bronze table.</p> <p>Parameters:</p> Name Type Description Default <code>spark</code> <code>SparkSession</code> <p>Active Spark session.</p> required <code>type</code> <code>str</code> <p>Folder inside the volume (e.g. departments, categories).</p> <code>'departments'</code> <code>catalog</code> <code>str</code> <p>Target catalog.</p> <code>'main'</code> <code>schema</code> <code>str</code> <p>Target schema.</p> <code>'default'</code> <code>table</code> <code>str</code> <p>Target table name.</p> <code>'test'</code> <code>volume</code> <code>str</code> <p>Source volume name.</p> <code>'staging'</code> <code>file_format</code> <code>str</code> <p>File format in the volume (json, parquet, csv...).</p> <code>'json'</code> <code>mode</code> <code>str</code> <p>Write mode for the table (\"append\" or \"overwrite\").</p> <code>'append'</code> <p>Returns:     None Example:     &gt;&gt;&gt; volumes_to_bronze(spark, type=\"departments\", catalog=\"main\", schema=\"default\", table=\"departments_bronze\", volume=\"staging\", file_format=\"json\", mode=\"append\")     &gt;&gt;&gt; volumes_to_bronze(spark, type=\"categories\", catalog=\"main\", schema=\"default\", table=\"categories_bronze\", volume=\"staging\", file_format=\"parquet\", mode=\"</p> Source code in <code>src\\scraping_coto\\etl\\bronze\\staging_to_bronze.py</code> <pre><code>def volumes_to_bronze(spark: SparkSession, type: FOLDERTYPE = \"departments\", catalog: str = \"main\", schema: str = \"default\", table: str = \"test\", volume: str = \"staging\", file_format: str = \"json\", mode: str = \"append\"):\n    \"\"\"\n        Load raw files from a Unity Catalog volume and save them into a Bronze table.\n\n        Args:\n            spark (SparkSession): Active Spark session.\n            type (str): Folder inside the volume (e.g. departments, categories).\n            catalog (str): Target catalog.\n            schema (str): Target schema.\n            table (str): Target table name.\n            volume (str): Source volume name.\n            file_format (str): File format in the volume (json, parquet, csv...).\n            mode (str): Write mode for the table (\"append\" or \"overwrite\").\n        Returns:\n            None\n        Example:\n            &gt;&gt;&gt; volumes_to_bronze(spark, type=\"departments\", catalog=\"main\", schema=\"default\", table=\"departments_bronze\", volume=\"staging\", file_format=\"json\", mode=\"append\")\n            &gt;&gt;&gt; volumes_to_bronze(spark, type=\"categories\", catalog=\"main\", schema=\"default\", table=\"categories_bronze\", volume=\"staging\", file_format=\"parquet\", mode=\"\n    \"\"\"\n\n    logger.info(f\"Starting saving data for table {catalog}.{schema}.{table}!\")\n    base_path = f\"/Volumes/{catalog}/{schema}/{volume}/{type}\"\n    schema_path = f\"{base_path}/schema\"\n    checkpoint_path = f\"{base_path}/checkpoints\"\n    files_path = f\"{base_path}/files\"\n\n    try:\n        # Garantindo que os diret\u00f3rios existem\n        dbutils.fs.mkdirs(schema_path)\n        dbutils.fs.mkdirs(checkpoint_path)\n        dbutils.fs.mkdirs(files_path)\n\n        # Usando Auto Loader para ler os dados de forma incremental, mantendo processamento em batch (trigger once)\n        df = (\n            spark.readStream.format(\"cloudFiles\")\n            .option(\"cloudFiles.format\", file_format)\n            .option(\"multiLine\", \"true\")\n            # .option(\"cloudFiles.inferColumnTypes\", \"true\")\n            .option(\"cloudFiles.schemaLocation\", schema_path)\n            .option(\"cloudFiles.schemaEvolutionMode\", \"rescue\")\n            # .option(\"cloudFiles.schemaEvolutionMode\", \"addNewColumns\")\n            .load(files_path)\n        )\n\n        # Escrevendo tabela Delta usando trigger once, que realiza o processo em batch\n        (\n            df.writeStream\n            .format(\"delta\")\n            .option(\"checkpointLocation\", checkpoint_path)\n            .option(\"delta.enableChangeDataFeed\", \"true\")\n            .trigger(once=True)\n            .table(f\"{catalog}.{schema}.{table}\")\n        )\n\n        logger.info(f\"Saved data to {catalog}.{schema}.{table} as stream!\")\n\n    except Exception as e:\n        logger.error(f\"Failed to load or save data from {base_path}: {e}\")\n        raise\n</code></pre>"},{"location":"reference/scraping_coto/etl/gold/silver_to_gold/","title":"silver_to_gold","text":""},{"location":"reference/scraping_coto/etl/gold/silver_to_gold/#scraping_coto.etl.gold.silver_to_gold","title":"scraping_coto.etl.gold.silver_to_gold","text":""},{"location":"reference/scraping_coto/etl/gold/silver_to_gold/#scraping_coto.etl.gold.silver_to_gold-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/etl/gold/silver_to_gold/#scraping_coto.etl.gold.silver_to_gold.load_gold_items_table","title":"load_gold_items_table","text":"<pre><code>load_gold_items_table(source_catalog_name: str, source_schema_name: str, source_table_name: str, target_catalog_name: str, target_schema_name: str, target_table_name: str, **options: Dict[str, Any]) -&gt; DataFrame\n</code></pre> <p>Load and transform silver items data into gold layer with department hierarchy.</p> <p>This function reads from silver layer items, joins with department hierarchy, applies AI-based extraction for product details, and writes to gold layer with support for merge, append, or overwrite modes.</p> <p>Parameters:</p> Name Type Description Default <code>source_catalog_name</code> <code>str</code> <p>Source catalog name (e.g., 'coto_dev')</p> required <code>source_schema_name</code> <code>str</code> <p>Source schema name (e.g., 'silver')</p> required <code>source_table_name</code> <code>str</code> <p>Source table name (e.g., 'items')</p> required <code>target_catalog_name</code> <code>str</code> <p>Target catalog name (e.g., 'coto_dev')</p> required <code>target_schema_name</code> <code>str</code> <p>Target schema name (e.g., 'gold')</p> required <code>target_table_name</code> <code>str</code> <p>Target table name (e.g., 'items')</p> required <code>**options</code> <code>Dict[str, Any]</code> <p>Additional processing options: - partition_by (List[str]): Columns to partition by (default: None) - mode (str): Write mode - 'append', 'overwrite', 'merge' (default: 'overwrite') - merge_keys (List[str]): Keys for merge operations (default: None) - start_date (str): Filter start date in ISO format (default: None) - end_date (str): Filter end date in ISO format (default: today) - date_column (str): Date column name for filtering (default: 'dt')</p> <code>{}</code> <p>Returns:</p> Name Type Description <code>DataFrame</code> <code>DataFrame</code> <p>The transformed gold items DataFrame</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If merge mode is used without merge_keys</p> <code>Exception</code> <p>For any processing errors</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Overwrite mode\n&gt;&gt;&gt; df = load_gold_items_table(\n...     'coto_dev', 'silver', 'items',\n...     'coto_dev', 'gold', 'items',\n...     partition_by=['dt'],\n...     mode='overwrite'\n... )\n</code></pre> <pre><code>&gt;&gt;&gt; # Merge mode with date range\n&gt;&gt;&gt; df = load_gold_items_table(\n...     'coto_dev', 'silver', 'items',\n...     'coto_dev', 'gold', 'items',\n...     mode='merge',\n...     merge_keys=['item_id', 'dt'],\n...     start_date='2025-01-01',\n...     end_date='2025-01-31'\n... )\n</code></pre> Source code in <code>src\\scraping_coto\\etl\\gold\\silver_to_gold.py</code> <pre><code>def load_gold_items_table(\n        source_catalog_name: str, \n        source_schema_name: str, \n        source_table_name: str, \n        target_catalog_name: str, \n        target_schema_name: str, \n        target_table_name: str,\n        **options: Dict[str, Any]\n    ) -&gt; DataFrame:\n    \"\"\"\n    Load and transform silver items data into gold layer with department hierarchy.\n\n    This function reads from silver layer items, joins with department hierarchy,\n    applies AI-based extraction for product details, and writes to gold layer\n    with support for merge, append, or overwrite modes.\n\n    Args:\n        source_catalog_name: Source catalog name (e.g., 'coto_dev')\n        source_schema_name: Source schema name (e.g., 'silver')\n        source_table_name: Source table name (e.g., 'items')\n        target_catalog_name: Target catalog name (e.g., 'coto_dev')\n        target_schema_name: Target schema name (e.g., 'gold')\n        target_table_name: Target table name (e.g., 'items')\n        **options: Additional processing options:\n            - partition_by (List[str]): Columns to partition by (default: None)\n            - mode (str): Write mode - 'append', 'overwrite', 'merge' (default: 'overwrite')\n            - merge_keys (List[str]): Keys for merge operations (default: None)\n            - start_date (str): Filter start date in ISO format (default: None)\n            - end_date (str): Filter end date in ISO format (default: today)\n            - date_column (str): Date column name for filtering (default: 'dt')\n\n    Returns:\n        DataFrame: The transformed gold items DataFrame\n\n    Raises:\n        ValueError: If merge mode is used without merge_keys\n        Exception: For any processing errors\n\n    Examples:\n        &gt;&gt;&gt; # Overwrite mode\n        &gt;&gt;&gt; df = load_gold_items_table(\n        ...     'coto_dev', 'silver', 'items',\n        ...     'coto_dev', 'gold', 'items',\n        ...     partition_by=['dt'],\n        ...     mode='overwrite'\n        ... )\n\n        &gt;&gt;&gt; # Merge mode with date range\n        &gt;&gt;&gt; df = load_gold_items_table(\n        ...     'coto_dev', 'silver', 'items',\n        ...     'coto_dev', 'gold', 'items',\n        ...     mode='merge',\n        ...     merge_keys=['item_id', 'dt'],\n        ...     start_date='2025-01-01',\n        ...     end_date='2025-01-31'\n        ... )\n    \"\"\"\n\n    source_table_path = f'{source_catalog_name}.{source_schema_name}.{source_table_name}'\n    target_table_path = f'{target_catalog_name}.{target_schema_name}.{target_table_name}'\n\n    logger.info(f\"Loading gold items: {target_table_path} from source: {source_table_path}\")\n    logger.info(f\"Options: {options}\")\n\n    try:\n        # Extract and validate options\n        partition_by: Optional[List[str]] = options.get('partition_by')\n        mode: str = options.get('mode', 'overwrite')\n        merge_keys: Optional[List[str]] = options.get('merge_keys')\n        start_date: Optional[str] = options.get('start_date', (date.today() - timedelta(days=1)).isoformat())\n        end_date: str = options.get('end_date', date.today().isoformat())\n        date_column: str = options.get('date_column', 'dt')\n\n        # Validate merge mode\n        if mode == 'merge' and not merge_keys:\n            raise ValueError(\"merge_keys must be provided when using mode='merge'\")\n\n        # Check if target exists\n        target_exists = spark.catalog.tableExists(target_table_path)\n        logger.info(f\"Target table exists: {target_exists}\")\n\n        # Build department hierarchy\n        logger.info(\"Building department hierarchy...\")\n        df_dept = _build_department_hierarchy(\n            source_catalog_name, \n            source_schema_name,\n            start_date,\n            end_date,\n            date_column\n        )\n\n        # Build gold items with enrichments\n        logger.info(\"Transforming items to gold layer...\")\n        df_gold_items = _transform_items_to_gold(\n            source_catalog_name,\n            source_schema_name, \n            source_table_name,\n            df_dept,\n            start_date,\n            end_date,\n            date_column\n        )\n\n        # Write based on mode\n        _write_gold_table(\n            df_gold_items,\n            target_table_path,\n            target_exists,\n            mode,\n            merge_keys,\n            partition_by,\n            date_column\n        )\n\n        logger.info(f\"Successfully processed records to {target_table_path}\")\n        return df_gold_items\n\n    except Exception as e:\n        logger.error(f\"Failed to load gold items table: {e}\")\n        raise\n</code></pre>"},{"location":"reference/scraping_coto/etl/silver/bronze_to_silver/","title":"bronze_to_silver","text":""},{"location":"reference/scraping_coto/etl/silver/bronze_to_silver/#scraping_coto.etl.silver.bronze_to_silver","title":"scraping_coto.etl.silver.bronze_to_silver","text":""},{"location":"reference/scraping_coto/etl/silver/bronze_to_silver/#scraping_coto.etl.silver.bronze_to_silver-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/etl/silver/bronze_to_silver/#scraping_coto.etl.silver.bronze_to_silver.load_to_silver","title":"load_to_silver","text":"<pre><code>load_to_silver(target_catalog: str, target_schema: str, target_table: str, source_catalog: str, source_schema: str, source_table: str, partition_by: list = None, options: dict = {})\n</code></pre> <p>Load data from bronze to silver layer with transformations. Args:     target_catalog (str): Target catalog for silver layer.     target_schema (str): Target schema for silver layer.     target_table (str): Target table for silver layer.     source_catalog (str): Source catalog for bronze layer.     source_schema (str): Source schema for bronze layer.     source_table (str): Source table for bronze layer.     partition_by (list, optional): List of columns to partition the target table by. Defaults to None.     options (dict, optional):          Additional options for writing the data. Defaults to an empty dictionary.          These are passed to the DataFrameWriter options. Which can include options like:         - \"maxFilesPerTrigger\": Limits the number of files processed in each trigger. Returns:     DataFrame: Transformed DataFrame written to silver layer. Example:     &gt;&gt;&gt; load_to_silver(target_catalog=\"main\", target_schema=\"silver\", target_table=\"departments\", source_catalog=\"main\", source_schema=\"bronze\", source_table=\"departments_bronze\", partition_by=[\"country\"], options={\"maxFilesPerTrigger\": 10})     &gt;&gt;&gt; load_to_silver(target_catalog=\"main\", target_schema=\"silver\", target_table=\"items\", source_catalog=\"main\", source_schema=\"bronze\", source_table=\"items_bronze\")</p> Source code in <code>src\\scraping_coto\\etl\\silver\\bronze_to_silver.py</code> <pre><code>def load_to_silver(target_catalog: str, target_schema: str, target_table: str, source_catalog: str, source_schema: str, source_table: str, partition_by: list = None, options: dict = {}):\n    \"\"\"\n        Load data from bronze to silver layer with transformations.\n        Args:\n            target_catalog (str): Target catalog for silver layer.\n            target_schema (str): Target schema for silver layer.\n            target_table (str): Target table for silver layer.\n            source_catalog (str): Source catalog for bronze layer.\n            source_schema (str): Source schema for bronze layer.\n            source_table (str): Source table for bronze layer.\n            partition_by (list, optional): List of columns to partition the target table by. Defaults to None.\n            options (dict, optional): \n                Additional options for writing the data. Defaults to an empty dictionary. \n                These are passed to the DataFrameWriter options. Which can include options like:\n                - \"maxFilesPerTrigger\": Limits the number of files processed in each trigger.\n        Returns:\n            DataFrame: Transformed DataFrame written to silver layer.\n        Example:\n            &gt;&gt;&gt; load_to_silver(target_catalog=\"main\", target_schema=\"silver\", target_table=\"departments\", source_catalog=\"main\", source_schema=\"bronze\", source_table=\"departments_bronze\", partition_by=[\"country\"], options={\"maxFilesPerTrigger\": 10})\n            &gt;&gt;&gt; load_to_silver(target_catalog=\"main\", target_schema=\"silver\", target_table=\"items\", source_catalog=\"main\", source_schema=\"bronze\", source_table=\"items_bronze\")\n    \"\"\"\n\n    source_table_path = f\"{source_catalog}.{source_schema}.{source_table}\"\n    target_table_path = f\"{target_catalog}.{target_schema}.{target_table}\"\n    checkpoint_path = f\"/Volumes/{target_catalog}/{target_schema}/checkpoints/{target_table}\"\n\n    logger.info(f\"Starting saving data from table {source_table_path} to {target_table_path}, using streaming!\")\n\n    df = spark.readStream.format(\"delta\").table(source_table_path)\n\n    logger.info(f\"Checkpoint path: {checkpoint_path}\")\n\n    # Garantindo que os diret\u00f3rios existem\n    dbutils.fs.mkdirs(checkpoint_path)\n\n    if target_table == \"departments\":\n        logger.info(\"Transforming departments data...\")\n        df_transformed = transform_departments(df)\n\n    elif target_table == \"categories\":\n        logger.info(\"Transforming categories data...\")\n        df_transformed = transform_categories(df)\n\n    elif target_table == \"subcategories\":\n        logger.info(\"Transforming subcategories data...\")\n        df_transformed = transform_subcategories(df)\n\n    elif target_table == \"items\":\n        logger.info(\"Transforming items data...\")\n        df_transformed = transform_items(df)\n\n    else:\n        raise ValueError(f\"Unknown table: {target_table}\")\n\n    logger.info(f\"Writing transformed data to silver table {target_table_path}...\")\n\n    writer = df_transformed.writeStream.format(\"delta\").option(\"checkpointLocation\", checkpoint_path).outputMode(\"append\")\n\n    if partition_by:\n        logger.info(f\"Partitioning by columns: {partition_by}\")\n        writer = writer.partitionBy(partition_by)\n\n    for option_key, option_value in options.items():\n        logger.info(f\"Setting writer option: {option_key} = {option_value}\")\n        writer = writer.option(option_key, option_value)\n\n    logger.info(f\"Starting the streaming write operation for table {target_table_path}...\")\n    silver_table = (\n        writer\n        .trigger(availableNow=True)\n        .table(target_table_path)\n    )\n\n    silver_table.awaitTermination()\n    logger.info(f\"Successfully completed streaming write to {target_table_path}\")\n\n    try:\n        result_count = spark.table(target_table_path).count()\n        logger.info(f\"Silver table {target_table_path} now has {result_count} rows\")\n    except Exception as e:\n        logger.warning(f\"Could not verify row count: {e}\")\n\n    return silver_table\n</code></pre>"},{"location":"reference/scraping_coto/etl/silver/schemas/categories/","title":"categories","text":""},{"location":"reference/scraping_coto/etl/silver/schemas/categories/#scraping_coto.etl.silver.schemas.categories","title":"scraping_coto.etl.silver.schemas.categories","text":""},{"location":"reference/scraping_coto/etl/silver/schemas/categories/#scraping_coto.etl.silver.schemas.categories-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/etl/silver/schemas/categories/#scraping_coto.etl.silver.schemas.categories.category_schema","title":"category_schema","text":"<pre><code>category_schema()\n</code></pre> <p>Define the schema for category data.</p> <p>Returns:</p> Name Type Description <code>ArrayType</code> <p>Schema for category data.</p> Source code in <code>src\\scraping_coto\\etl\\silver\\schemas\\categories.py</code> <pre><code>def category_schema():\n    \"\"\" \n        Define the schema for category data.\n\n        Returns:\n            ArrayType: Schema for category data.\n    \"\"\"\n\n    cat_schema = ArrayType(\n        StructType([\n            StructField(\"@type\", StringType(), True),\n            StructField(\"Footer\", ArrayType(\n                StructType([\n                    StructField(\"@type\", StringType(), True),\n                    StructField(\"contentPaths\", ArrayType(StringType(), True), True),\n                    StructField(\"contents\", ArrayType(\n                        StructType([\n                            StructField(\"@type\", StringType(), True),\n                            StructField(\"FooterBottom\", ArrayType(\n                                StructType([\n                                    StructField(\"@type\", StringType(), True),\n                                    StructField(\"content\", StringType(), True),\n                                    StructField(\"endeca:auditInfo\", StructType([\n                                        StructField(\"ecr:innerPath\", StringType(), True),\n                                        StructField(\"ecr:resourcePath\", StringType(), True)\n                                    ]), True),\n                                    StructField(\"image_src\", StringType(), True),\n                                    StructField(\"linkClass\", StringType(), True),\n                                    StructField(\"name\", StringType(), True)\n                                ]), True\n                            ), True),\n                            StructField(\"FooterCenter\", ArrayType(\n                                StructType([\n                                    StructField(\"@type\", StringType(), True),\n                                    StructField(\"content\", StringType(), True),\n                                    StructField(\"endeca:auditInfo\", StructType([\n                                        StructField(\"ecr:innerPath\", StringType(), True),\n                                        StructField(\"ecr:resourcePath\", StringType(), True)\n                                    ]), True),\n                                    StructField(\"image_src\", StringType(), True),\n                                    StructField(\"label\", StringType(), True),\n                                    StructField(\"link\", StructType([\n                                        StructField(\"@class\", StringType(), True),\n                                        StructField(\"linkType\", StringType(), True),\n                                        StructField(\"path\", StringType(), True),\n                                        StructField(\"queryString\", StringType(), True)\n                                    ]), True),\n                                    StructField(\"linkClass\", StringType(), True),\n                                    StructField(\"name\", StringType(), True),\n                                    StructField(\"subitems\", ArrayType(\n                                        StructType([\n                                            StructField(\"@type\", StringType(), True),\n                                            StructField(\"endeca:auditInfo\", StructType([\n                                                StructField(\"ecr:innerPath\", StringType(), True),\n                                                StructField(\"ecr:resourcePath\", StringType(), True)\n                                            ]), True),\n                                            StructField(\"isButton\", BooleanType(), True),\n                                            StructField(\"isIMG\", BooleanType(), True),\n                                            StructField(\"label\", StringType(), True),\n                                            StructField(\"link\", StructType([\n                                                StructField(\"@class\", StringType(), True),\n                                                StructField(\"linkType\", StringType(), True),\n                                                StructField(\"path\", StringType(), True),\n                                                StructField(\"queryString\", StringType(), True)\n                                            ]), True),\n                                            StructField(\"linkClass\", StringType(), True),\n                                            StructField(\"name\", StringType(), True),\n                                            StructField(\"src\", StringType(), True),\n                                            StructField(\"subitems\", ArrayType(StringType(), True), True),\n                                            StructField(\"typeRedirect\", StringType(), True)\n                                        ]), True\n                                    ), True)\n                                ]), True\n                            ), True),\n                            StructField(\"FooterTop\", ArrayType(\n                                StructType([\n                                    StructField(\"@type\", StringType(), True),\n                                    StructField(\"displayNamePropertyAlias\", StringType(), True),\n                                    StructField(\"endeca:auditInfo\", StructType([\n                                        StructField(\"ecr:innerPath\", StringType(), True),\n                                        StructField(\"ecr:resourcePath\", StringType(), True)\n                                    ]), True),\n                                    StructField(\"isFooter\", BooleanType(), True),\n                                    StructField(\"name\", StringType(), True)\n                                ]), True\n                            ), True),\n                            StructField(\"endeca:auditInfo\", StructType([\n                                StructField(\"ecr:innerPath\", StringType(), True),\n                                StructField(\"ecr:resourcePath\", StringType(), True)\n                            ]), True),\n                            StructField(\"name\", StringType(), True)\n                        ]), True\n                    ), True),\n                    StructField(\"endeca:auditInfo\", StructType([\n                        StructField(\"ecr:innerPath\", StringType(), True),\n                        StructField(\"ecr:resourcePath\", StringType(), True)\n                    ]), True),\n                    StructField(\"name\", StringType(), True),\n                    StructField(\"ruleLimit\", StringType(), True),\n                    StructField(\"templateIds\", ArrayType(StringType(), True), True),\n                    StructField(\"templateTypes\", ArrayType(StringType(), True), True)\n                ]), True\n            ), True),\n            StructField(\"Header\", ArrayType(\n                StructType([\n                    StructField(\"@type\", StringType(), True),\n                    StructField(\"contentPaths\", ArrayType(StringType(), True), True),\n                    StructField(\"contents\", ArrayType(\n                        StructType([\n                            StructField(\"@type\", StringType(), True),\n                            StructField(\"Bottom\", ArrayType(\n                                StructType([\n                                    StructField(\"@type\", StringType(), True),\n                                    StructField(\"displayNamePropertyAlias\", StringType(), True),\n                                    StructField(\"endeca:auditInfo\", StructType([\n                                        StructField(\"ecr:innerPath\", StringType(), True),\n                                        StructField(\"ecr:resourcePath\", StringType(), True)\n                                    ]), True),\n                                    StructField(\"name\", StringType(), True)\n                                ]), True\n                            ), True),\n                            StructField(\"Center\", ArrayType(\n                                StructType([\n                                    StructField(\"@type\", StringType(), True),\n                                    StructField(\"displayNamePropertyAlias\", StringType(), True),\n                                    StructField(\"endeca:auditInfo\", StructType([\n                                        StructField(\"ecr:innerPath\", StringType(), True),\n                                        StructField(\"ecr:resourcePath\", StringType(), True)\n                                    ]), True),\n                                    StructField(\"image_src\", StringType(), True),\n                                    StructField(\"link\", StructType([\n                                        StructField(\"@class\", StringType(), True),\n                                        StructField(\"linkType\", StringType(), True),\n                                        StructField(\"path\", StringType(), True),\n                                        StructField(\"queryString\", StringType(), True)\n                                    ]), True),\n                                    StructField(\"linkClass\", StringType(), True),\n                                    StructField(\"name\", StringType(), True),\n                                    StructField(\"urlImage\", StringType(), True)\n                                ]), True\n                            ), True),\n                            StructField(\"Mobile\", ArrayType(\n                                StructType([\n                                    StructField(\"@type\", StringType(), True),\n                                    StructField(\"displayNamePropertyAlias\", StringType(), True),\n                                    StructField(\"endeca:auditInfo\", StructType([\n                                        StructField(\"ecr:innerPath\", StringType(), True),\n                                        StructField(\"ecr:resourcePath\", StringType(), True)\n                                    ]), True),\n                                    StructField(\"name\", StringType(), True)\n                                ]), True\n                            ), True),\n                            StructField(\"Top\", ArrayType(\n                                StructType([\n                                    StructField(\"@type\", StringType(), True),\n                                    StructField(\"displayNamePropertyAlias\", StringType(), True),\n                                    StructField(\"endeca:auditInfo\", StructType([\n                                        StructField(\"ecr:innerPath\", StringType(), True),\n                                        StructField(\"ecr:resourcePath\", StringType(), True)\n                                    ]), True),\n                                    StructField(\"name\", StringType(), True),\n                                    StructField(\"subitems\", ArrayType(\n                                        StructType([\n                                            StructField(\"@type\", StringType(), True),\n                                            StructField(\"Suscription\", ArrayType(StringType(), True), True),\n                                            StructField(\"endeca:auditInfo\", StructType([\n                                                StructField(\"ecr:innerPath\", StringType(), True),\n                                                StructField(\"ecr:resourcePath\", StringType(), True)\n                                            ]), True),\n                                            StructField(\"label\", StringType(), True),\n                                            StructField(\"link\", StructType([\n                                                StructField(\"@class\", StringType(), True),\n                                                StructField(\"linkType\", StringType(), True),\n                                                StructField(\"path\", StringType(), True),\n                                                StructField(\"queryString\", StringType(), True)\n                                            ]), True),\n                                            StructField(\"linkClass\", StringType(), True),\n                                            StructField(\"name\", StringType(), True),\n                                            StructField(\"subitems\", ArrayType(StringType(), True), True)\n                                        ]), True\n                                    ), True)\n                                ]), True\n                            ), True),\n                            StructField(\"endeca:auditInfo\", StructType([\n                                StructField(\"ecr:innerPath\", StringType(), True),\n                                StructField(\"ecr:resourcePath\", StringType(), True)\n                            ]), True),\n                            StructField(\"name\", StringType(), True)\n                        ]), True\n                    ), True),\n                    StructField(\"endeca:auditInfo\", StructType([\n                        StructField(\"ecr:innerPath\", StringType(), True),\n                        StructField(\"ecr:resourcePath\", StringType(), True)\n                    ]), True),\n                    StructField(\"name\", StringType(), True),\n                    StructField(\"ruleLimit\", StringType(), True),\n                    StructField(\"templateIds\", ArrayType(StringType(), True), True),\n                    StructField(\"templateTypes\", ArrayType(StringType(), True), True)\n                ]), True\n            ), True),\n            StructField(\"Left\", ArrayType(\n                StructType([\n                    StructField(\"@type\", StringType(), True),\n                    StructField(\"contentPaths\", ArrayType(StringType(), True), True),\n                    StructField(\"contents\", ArrayType(\n                        StructType([\n                            StructField(\"@type\", StringType(), True),\n                            StructField(\"categories\", ArrayType(\n                                StructType([\n                                    StructField(\"subCategories\", ArrayType(\n                                        StructType([\n                                            StructField(\"categoryId\", StringType(), True),\n                                            StructField(\"displayName\", StringType(), True),\n                                            StructField(\"navigationState\", StringType(), True),\n                                            StructField(\"subCategories2\", ArrayType(\n                                                StructType([\n                                                    StructField(\"categoryId\", StringType(), True),\n                                                    StructField(\"displayName\", StringType(), True),\n                                                    StructField(\"navigationState\", StringType(), True)\n                                                ]), True\n                                            ), True)\n                                        ]), True\n                                    ), True),\n                                    StructField(\"topLevelCategory\", StructType([\n                                        StructField(\"categoryId\", StringType(), True),\n                                        StructField(\"displayName\", StringType(), True),\n                                        StructField(\"heroImageDescription\", StringType(), True),\n                                        StructField(\"heroImageUrl\", StringType(), True),\n                                        StructField(\"navigationState\", StringType(), True),\n                                        StructField(\"smallImageUrl\", StringType(), True)\n                                    ]), True)\n                                ]), True\n                            ), True),\n                            StructField(\"endeca:auditInfo\", StructType([\n                                StructField(\"ecr:innerPath\", StringType(), True),\n                                StructField(\"ecr:resourcePath\", StringType(), True)\n                            ]), True),\n                            StructField(\"name\", StringType(), True),\n                            StructField(\"navigation\", ArrayType(\n                                StructType([\n                                    StructField(\"@type\", StringType(), True),\n                                    StructField(\"ancestors\", ArrayType(\n                                        StructType([\n                                            StructField(\"@class\", StringType(), True),\n                                            StructField(\"contentPath\", StringType(), True),\n                                            StructField(\"label\", StringType(), True),\n                                            StructField(\"navigationState\", StringType(), True),\n                                            StructField(\"properties\", StructType([\n                                                StructField(\"DGraph.More\", StringType(), True),\n                                                StructField(\"DGraph.Spec\", StringType(), True),\n                                                StructField(\"category.ancestorCatalogIds\", StringType(), True),\n                                                StructField(\"category.catalogs.repositoryId\", StringType(), True),\n                                                StructField(\"category.repositoryId\", StringType(), True),\n                                                StructField(\"category.rootCatalogId\", StringType(), True),\n                                                StructField(\"category.siteId\", StringType(), True),\n                                                StructField(\"displayName_es\", StringType(), True),\n                                                StructField(\"record.id\", StringType(), True)\n                                            ]), True),\n                                            StructField(\"siteRootPath\", StringType(), True),\n                                            StructField(\"siteState\", StructType([\n                                                StructField(\"@class\", StringType(), True),\n                                                StructField(\"contentPath\", StringType(), True),\n                                                StructField(\"matchedUrlPattern\", StringType(), True),\n                                                StructField(\"siteDefinition\", StructType([\n                                                    StructField(\"@class\", StringType(), True),\n                                                    StructField(\"displayName\", StringType(), True),\n                                                    StructField(\"filterStateConfiguration\", StringType(), True),\n                                                    StructField(\"id\", StringType(), True),\n                                                    StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                                    StructField(\"urlPattern\", StringType(), True)\n                                                ]), True),\n                                                StructField(\"siteId\", StringType(), True),\n                                                StructField(\"validSite\", BooleanType(), True)\n                                            ]), True)\n                                        ]), True\n                                    ), True),\n                                    StructField(\"dimensionName\", StringType(), True),\n                                    StructField(\"displayName\", StringType(), True),\n                                    StructField(\"displayNameProperty\", StringType(), True),\n                                    StructField(\"displayNamePropertyAlias\", StringType(), True),\n                                    StructField(\"endeca:auditInfo\", StructType([\n                                        StructField(\"ecr:innerPath\", StringType(), True),\n                                        StructField(\"ecr:resourcePath\", StringType(), True)\n                                    ]), True),\n                                    StructField(\"moreLink\", StructType([\n                                        StructField(\"@class\", StringType(), True),\n                                        StructField(\"contentPath\", StringType(), True),\n                                        StructField(\"label\", StringType(), True),\n                                        StructField(\"navigationState\", StringType(), True),\n                                        StructField(\"siteRootPath\", StringType(), True),\n                                        StructField(\"siteState\", StructType([\n                                            StructField(\"@class\", StringType(), True),\n                                            StructField(\"contentPath\", StringType(), True),\n                                            StructField(\"matchedUrlPattern\", StringType(), True),\n                                            StructField(\"siteDefinition\", StructType([\n                                                StructField(\"@class\", StringType(), True),\n                                                StructField(\"displayName\", StringType(), True),\n                                                StructField(\"filterStateConfiguration\", StringType(), True),\n                                                StructField(\"id\", StringType(), True),\n                                                StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                                StructField(\"urlPattern\", StringType(), True)\n                                            ]), True),\n                                            StructField(\"siteId\", StringType(), True),\n                                            StructField(\"validSite\", BooleanType(), True)\n                                        ]), True)\n                                    ]), True),\n                                    StructField(\"multiSelect\", BooleanType(), True),\n                                    StructField(\"name\", StringType(), True),\n                                    StructField(\"refinements\", ArrayType(\n                                        StructType([\n                                            StructField(\"@class\", StringType(), True),\n                                            StructField(\"contentPath\", StringType(), True),\n                                            StructField(\"count\", LongType(), True),\n                                            StructField(\"label\", StringType(), True),\n                                            StructField(\"multiSelect\", BooleanType(), True),\n                                            StructField(\"navigationState\", StringType(), True),\n                                            StructField(\"properties\", StructType([\n                                                StructField(\"DGraph.Spec\", StringType(), True),\n                                                StructField(\"DGraph.Strata\", StringType(), True),\n                                                StructField(\"category.ancestorCatalogIds\", StringType(), True),\n                                                StructField(\"category.catalogs.repositoryId\", StringType(), True),\n                                                StructField(\"category.repositoryId\", StringType(), True),\n                                                StructField(\"category.rootCatalogId\", StringType(), True),\n                                                StructField(\"category.siteId\", StringType(), True),\n                                                StructField(\"displayName_es\", StringType(), True),\n                                                StructField(\"record.id\", StringType(), True)\n                                            ]), True),\n                                            StructField(\"siteRootPath\", StringType(), True),\n                                            StructField(\"siteState\", StructType([\n                                                StructField(\"@class\", StringType(), True),\n                                                StructField(\"contentPath\", StringType(), True),\n                                                StructField(\"matchedUrlPattern\", StringType(), True),\n                                                StructField(\"siteDefinition\", StructType([\n                                                    StructField(\"@class\", StringType(), True),\n                                                    StructField(\"displayName\", StringType(), True),\n                                                    StructField(\"filterStateConfiguration\", StringType(), True),\n                                                    StructField(\"id\", StringType(), True),\n                                                    StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                                    StructField(\"urlPattern\", StringType(), True)\n                                                ]), True),\n                                                StructField(\"siteId\", StringType(), True),\n                                                StructField(\"validSite\", BooleanType(), True)\n                                            ]), True)\n                                        ]), True\n                                    ), True),\n                                    StructField(\"whyPrecedenceRuleFired\", StringType(), True)\n                                ]), True\n                            ), True)\n                        ]), True\n                    ), True),\n                    StructField(\"displayNameProperty\", StringType(), True),\n                    StructField(\"displayNamePropertyAlias\", StringType(), True),\n                    StructField(\"endeca:auditInfo\", StructType([\n                        StructField(\"ecr:innerPath\", StringType(), True),\n                        StructField(\"ecr:resourcePath\", StringType(), True)\n                    ]), True),\n                    StructField(\"geoFilterCrumb\", StringType(), True),\n                    StructField(\"imageURL1\", StringType(), True),\n                    StructField(\"imageURL2\", StringType(), True),\n                    StructField(\"name\", StringType(), True),\n                    StructField(\"rangeFilterCrumbs\", ArrayType(\n                        StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"label\", StringType(), True),\n                            StructField(\"lowerBound\", StringType(), True),\n                            StructField(\"name\", StringType(), True),\n                            StructField(\"operation\", StringType(), True),\n                            StructField(\"propertyName\", StringType(), True),\n                            StructField(\"removeAction\", StructType([\n                                StructField(\"@class\", StringType(), True),\n                                StructField(\"contentPath\", StringType(), True),\n                                StructField(\"label\", StringType(), True),\n                                StructField(\"navigationState\", StringType(), True),\n                                StructField(\"siteRootPath\", StringType(), True),\n                                StructField(\"siteState\", StructType([\n                                    StructField(\"@class\", StringType(), True),\n                                    StructField(\"contentPath\", StringType(), True),\n                                    StructField(\"matchedUrlPattern\", StringType(), True),\n                                    StructField(\"siteDefinition\", StructType([\n                                        StructField(\"@class\", StringType(), True),\n                                        StructField(\"displayName\", StringType(), True),\n                                        StructField(\"filterStateConfiguration\", StringType(), True),\n                                        StructField(\"id\", StringType(), True),\n                                        StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                        StructField(\"urlPattern\", StringType(), True)\n                                    ]), True),\n                                    StructField(\"siteId\", StringType(), True),\n                                    StructField(\"validSite\", BooleanType(), True)\n                                ]), True)\n                            ]), True),\n                            StructField(\"upperBound\", StringType(), True)\n                        ]), True\n                    ), True),\n                    StructField(\"refinementCrumbs\", ArrayType(\n                        StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"ancestors\", ArrayType(\n                                StructType([\n                                    StructField(\"@class\", StringType(), True),\n                                    StructField(\"contentPath\", StringType(), True),\n                                    StructField(\"label\", StringType(), True),\n                                    StructField(\"navigationState\", StringType(), True),\n                                    StructField(\"properties\", StructType([\n                                        StructField(\"DGraph.Spec\", StringType(), True),\n                                        StructField(\"category.ancestorCatalogIds\", StringType(), True),\n                                        StructField(\"category.catalogs.repositoryId\", StringType(), True),\n                                        StructField(\"category.repositoryId\", StringType(), True),\n                                        StructField(\"category.rootCatalogId\", StringType(), True),\n                                        StructField(\"category.siteId\", StringType(), True),\n                                        StructField(\"displayName_es\", StringType(), True),\n                                        StructField(\"record.id\", StringType(), True)\n                                    ]), True),\n                                    StructField(\"siteRootPath\", StringType(), True),\n                                    StructField(\"siteState\", StructType([\n                                        StructField(\"@class\", StringType(), True),\n                                        StructField(\"contentPath\", StringType(), True),\n                                        StructField(\"matchedUrlPattern\", StringType(), True),\n                                        StructField(\"siteDefinition\", StructType([\n                                            StructField(\"@class\", StringType(), True),\n                                            StructField(\"displayName\", StringType(), True),\n                                            StructField(\"filterStateConfiguration\", StringType(), True),\n                                            StructField(\"id\", StringType(), True),\n                                            StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                            StructField(\"urlPattern\", StringType(), True)\n                                        ]), True),\n                                        StructField(\"siteId\", StringType(), True),\n                                        StructField(\"validSite\", BooleanType(), True)\n                                    ]), True)\n                                ]), True\n                            ), True),\n                            StructField(\"count\", LongType(), True),\n                            StructField(\"dimensionName\", StringType(), True),\n                            StructField(\"displayName\", StringType(), True),\n                            StructField(\"label\", StringType(), True),\n                            StructField(\"multiSelect\", BooleanType(), True),\n                            StructField(\"properties\", StructType([\n                                StructField(\"DGraph.More\", StringType(), True),\n                                StructField(\"DGraph.Spec\", StringType(), True),\n                                StructField(\"category.ancestorCatalogIds\", StringType(), True),\n                                StructField(\"category.catalogs.repositoryId\", StringType(), True),\n                                StructField(\"category.repositoryId\", StringType(), True),\n                                StructField(\"category.rootCatalogId\", StringType(), True),\n                                StructField(\"category.siteId\", StringType(), True),\n                                StructField(\"displayName_es\", StringType(), True),\n                                StructField(\"record.id\", StringType(), True)\n                            ]), True),\n                            StructField(\"removeAction\", StructType([\n                                StructField(\"@class\", StringType(), True),\n                                StructField(\"contentPath\", StringType(), True),\n                                StructField(\"label\", StringType(), True),\n                                StructField(\"navigationState\", StringType(), True),\n                                StructField(\"siteRootPath\", StringType(), True),\n                                StructField(\"siteState\", StructType([\n                                    StructField(\"@class\", StringType(), True),\n                                    StructField(\"contentPath\", StringType(), True),\n                                    StructField(\"matchedUrlPattern\", StringType(), True),\n                                    StructField(\"siteDefinition\", StructType([\n                                        StructField(\"@class\", StringType(), True),\n                                        StructField(\"displayName\", StringType(), True),\n                                        StructField(\"filterStateConfiguration\", StringType(), True),\n                                        StructField(\"id\", StringType(), True),\n                                        StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                        StructField(\"urlPattern\", StringType(), True)\n                                    ]), True),\n                                    StructField(\"siteId\", StringType(), True),\n                                    StructField(\"validSite\", BooleanType(), True)\n                                ]), True)\n                            ]), True)\n                        ]), True\n                    ), True),\n                    StructField(\"removeAllAction\", StructType([\n                        StructField(\"@class\", StringType(), True),\n                        StructField(\"contentPath\", StringType(), True),\n                        StructField(\"label\", StringType(), True),\n                        StructField(\"navigationState\", StringType(), True),\n                        StructField(\"siteRootPath\", StringType(), True),\n                        StructField(\"siteState\", StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"contentPath\", StringType(), True),\n                            StructField(\"matchedUrlPattern\", StringType(), True),\n                            StructField(\"siteDefinition\", StructType([\n                                StructField(\"@class\", StringType(), True),\n                                StructField(\"displayName\", StringType(), True),\n                                StructField(\"filterStateConfiguration\", StringType(), True),\n                                StructField(\"id\", StringType(), True),\n                                StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                StructField(\"urlPattern\", StringType(), True)\n                            ]), True),\n                            StructField(\"siteId\", StringType(), True),\n                            StructField(\"validSite\", BooleanType(), True)\n                        ]), True)\n                    ]), True),\n                    StructField(\"ruleLimit\", StringType(), True),\n                    StructField(\"searchCrumbs\", ArrayType(StringType(), True), True),\n                    StructField(\"templateIds\", ArrayType(StringType(), True), True),\n                    StructField(\"templateTypes\", ArrayType(StringType(), True), True),\n                    StructField(\"urlRedirect1\", StringType(), True),\n                    StructField(\"urlRedirect2\", StringType(), True)\n                ]), True\n            ), True),\n            StructField(\"Main\", ArrayType(\n                StructType([\n                    StructField(\"@type\", StringType(), True),\n                    StructField(\"bannerName\", StringType(), True),\n                    StructField(\"contentPaths\", ArrayType(StringType(), True), True),\n                    StructField(\"contents\", ArrayType(\n                        StructType([\n                            StructField(\"@type\", StringType(), True),\n                            StructField(\"endeca:auditInfo\", StructType([\n                                StructField(\"ecr:innerPath\", StringType(), True),\n                                StructField(\"ecr:resourcePath\", StringType(), True)\n                            ]), True),\n                            StructField(\"firstRecNum\", LongType(), True),\n                            StructField(\"json-ld\", StringType(), True),\n                            StructField(\"lastRecNum\", LongType(), True),\n                            StructField(\"name\", StringType(), True),\n                            StructField(\"pagingActionTemplate\", StructType([\n                                StructField(\"@class\", StringType(), True),\n                                StructField(\"contentPath\", StringType(), True),\n                                StructField(\"label\", StringType(), True),\n                                StructField(\"navigationState\", StringType(), True),\n                                StructField(\"siteRootPath\", StringType(), True),\n                                StructField(\"siteState\", StructType([\n                                    StructField(\"@class\", StringType(), True),\n                                    StructField(\"contentPath\", StringType(), True),\n                                    StructField(\"matchedUrlPattern\", StringType(), True),\n                                    StructField(\"siteDefinition\", StructType([\n                                        StructField(\"@class\", StringType(), True),\n                                        StructField(\"displayName\", StringType(), True),\n                                        StructField(\"filterStateConfiguration\", StringType(), True),\n                                        StructField(\"id\", StringType(), True),\n                                        StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                        StructField(\"urlPattern\", StringType(), True)\n                                    ]), True),\n                                    StructField(\"siteId\", StringType(), True),\n                                    StructField(\"validSite\", BooleanType(), True)\n                                ]), True)\n                            ]), True),\n                            StructField(\"precomputedSorts\", ArrayType(StringType(), True), True),\n                            StructField(\"records\", ArrayType(\n                                StructType([\n                                    StructField(\"@class\", StringType(), True),\n                                    StructField(\"attributes\", StructType([\n                                        StructField(\"product.displayName\", ArrayType(StringType(), True), True),\n                                        StructField(\"product.repositoryId\", ArrayType(StringType(), True), True)\n                                    ]), True),\n                                    StructField(\"detailsAction\", StructType([\n                                        StructField(\"@class\", StringType(), True),\n                                        StructField(\"contentPath\", StringType(), True),\n                                        StructField(\"label\", StringType(), True),\n                                        StructField(\"recordState\", StringType(), True),\n                                        StructField(\"siteRootPath\", StringType(), True),\n                                        StructField(\"siteState\", StructType([\n                                            StructField(\"@class\", StringType(), True),\n                                            StructField(\"contentPath\", StringType(), True),\n                                            StructField(\"matchedUrlPattern\", StringType(), True),\n                                            StructField(\"siteDefinition\", StructType([\n                                                StructField(\"@class\", StringType(), True),\n                                                StructField(\"displayName\", StringType(), True),\n                                                StructField(\"filterStateConfiguration\", StringType(), True),\n                                                StructField(\"id\", StringType(), True),\n                                                StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                                StructField(\"urlPattern\", StringType(), True)\n                                            ]), True),\n                                            StructField(\"siteId\", StringType(), True),\n                                            StructField(\"validSite\", BooleanType(), True)\n                                        ]), True)\n                                    ]), True),\n                                    StructField(\"numRecords\", LongType(), True),\n                                    StructField(\"records\", ArrayType(\n                                        StructType([\n                                            StructField(\"@class\", StringType(), True),\n                                            StructField(\"attributes\", StructType([\n                                                StructField(\"allAncestors.displayName\", ArrayType(StringType(), True), True),\n                                                StructField(\"allAncestors.repositoryId\", ArrayType(StringType(), True), True),\n                                                StructField(\"parentCategory.displayName\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.ACCIONAMIENTO AUTOMATICO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.BOTELLA RETORNABLE\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CABLE RETRACTIL\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CANASTO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CANTIDAD\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CAPACIDAD\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CAPACIDAD DE LAVADO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CAPACIDAD DE MOLIENDA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CAPACIDAD MAXIMA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CAPAS DE CONFORT\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CATEGORIA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CLASE\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CLIMATIZACION\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.COLOR\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.COMPOSICI\u00d3N DE TELA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.COMPOSICI\u00d3N TELA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CONECTIVIDAD\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CONTENIDO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CONTROL DE TEMPERATURA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CORTE AUTOMATICO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.CUADRO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.DEPTO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.DISPLAY DIGITAL\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.DURACI\u00d3N ESTIMADA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.EDAD\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.ELABORACI\u00d3N\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.ENVASADO AL VAC\u00cdO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.ENVASE\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.EQUIVALENTE A\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.ESTILO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.ESTRUCTURA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.ESTUCHE\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.ETAPA DE VIDA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.FAMILIA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.FORMA DE CALENTAMIENTO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.FRAGANCIAS\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.FRIGORIAS\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.GARANTIA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.GRAMAJE\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.G\u00c9NERO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.HORQUILLA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.IBU\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.INTERNA-EXTERNA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.KOSHER\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.LCLASE\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.LDEPAR\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.MARCA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.MATERIAL DE CUCHILLAS\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.MATERIAL DE PLACAS\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.MEDIDA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.MODELO DE L\u00c1MPARA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.MODELO DE ROSCA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.MODO DEPILACION\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.MOTOR\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.NIVEL DE FIRMEZA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.NOMBRE\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.ORIGEN\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.ORIGEN DE LA MARCA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.PAIS\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.PANEL DIGITAL\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.PESO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.PILLOW\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.POSICIONADOR\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.POTENCIA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.POTENCIA (WATS)\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.PRECISION\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.PRENSATELAS\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.PULGADAS\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.REGION\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.RELEVANCIA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.RESOLUCION\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.RODADO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.SABOR\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.SALIDA AL EXTERIOR\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.SELECTOR DE TEMPERATURA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.SIN TACC\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.SISTEMA DE FUNCIONAMIENTO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.SMART\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.SUBMARCA-L\u00cdNEA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.SUSPENSION\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TALLE\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TAMA\u00d1O\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TAMA\u00d1O DE LA RAZA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TARA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TECNOLOGIA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TEMPORIZADOR\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIMER PROGRAMABLE\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE AGUJA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE ALIMENTACION\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE ALIMENTO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE ASPIRADORA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE BALANZA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE BICICLETA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE CARGA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE CARNE\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE CERVEZA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE CORTE\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE EMPAQUE\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE EQUIPO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE FRENOS\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE LUZ\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE L\u00c1MPARA\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE MATERIAL\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE PRODUCTO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIPO DE VACUNO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TIRAJE\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TOTALDEVENTAS\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.TRABAJA EN FRIO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.ULTRA SILENCIOSO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.VARIETAL\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.VELOCIDAD DE CENTRIFUGADO\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.VELOCIDADES\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.VERSION CPU\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.VOLUMEN\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.adescr\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.auxiliaryMedia\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.averageCustomerRating\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.baseUrl\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.brand\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.briefDescription\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.cFormato\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.cantForm\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.cantidadMinima\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.catalogId\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.category\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.categoryRank\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.creationDate\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.dateAvailable\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.daysAvailable\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.description\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.disallowAsRecommendation\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.displayName\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.dtoCaracteristicas\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.dtoDescuentos\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.dtoDescuentosMediosPago\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.eanPrincipal\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.endDate\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.esPeque\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.idTipoGrupo\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.keywords\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.language\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.largeImage.url\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.ldescr\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.longDescription\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.mediumImage.url\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.nonreturnable\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.priceListPair\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.proveedorChico\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.repositoryId\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_056\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_060\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_061\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_063\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_064\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_065\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_075\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_078\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_085\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_090\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_091\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_092\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_107\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_109\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_129\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_131\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_133\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_160\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_165\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_178\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_181\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_182\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_184\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_185\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_188\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_189\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_197\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_200\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_204\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_209\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_215\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_219\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_220\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_238\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_400\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.sDisp_710\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.saltoCantidad\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.siteId\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.startDate\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.tipoOferta\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.unidades.descUnidad\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.unidades.esPesable\", ArrayType(StringType(), True), True),\n                                                StructField(\"product.url\", ArrayType(StringType(), True), True),\n                                                StructField(\"record.id\", ArrayType(StringType(), True), True),\n                                                StructField(\"record.source\", ArrayType(StringType(), True), True),\n                                                StructField(\"record.type\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.activePrice\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.baseUrl\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.creationDate\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.description\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.displayName\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.dtoPrice\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.endDate\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.margin\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.onSaleText\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.quantity\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.referencePrice\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.repositoryId\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.siteId\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.startDate\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.unit_of_measure\", ArrayType(StringType(), True), True),\n                                                StructField(\"sku.url\", ArrayType(StringType(), True), True)\n                                            ]), True),\n                                            StructField(\"detailsAction\", StructType([\n                                                StructField(\"@class\", StringType(), True),\n                                                StructField(\"contentPath\", StringType(), True),\n                                                StructField(\"label\", StringType(), True),\n                                                StructField(\"recordState\", StringType(), True),\n                                                StructField(\"siteRootPath\", StringType(), True),\n                                                StructField(\"siteState\", StructType([\n                                                    StructField(\"@class\", StringType(), True),\n                                                    StructField(\"contentPath\", StringType(), True),\n                                                    StructField(\"matchedUrlPattern\", StringType(), True),\n                                                    StructField(\"siteDefinition\", StructType([\n                                                        StructField(\"@class\", StringType(), True),\n                                                        StructField(\"displayName\", StringType(), True),\n                                                        StructField(\"filterStateConfiguration\", StringType(), True),\n                                                        StructField(\"id\", StringType(), True),\n                                                        StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                                        StructField(\"urlPattern\", StringType(), True)\n                                                    ]), True),\n                                                    StructField(\"siteId\", StringType(), True),\n                                                    StructField(\"validSite\", BooleanType(), True)\n                                                ]), True)\n                                            ]), True),\n                                            StructField(\"numRecords\", LongType(), True),\n                                            StructField(\"records\", StringType(), True)\n                                        ]), True\n                                    ), True)\n                                ]), True\n                            ), True),\n                            StructField(\"recsPerPage\", LongType(), True),\n                            StructField(\"sortOptions\", ArrayType(\n                                StructType([\n                                    StructField(\"@class\", StringType(), True),\n                                    StructField(\"contentPath\", StringType(), True),\n                                    StructField(\"label\", StringType(), True),\n                                    StructField(\"navigationState\", StringType(), True),\n                                    StructField(\"selected\", BooleanType(), True),\n                                    StructField(\"siteRootPath\", StringType(), True),\n                                    StructField(\"siteState\", StructType([\n                                        StructField(\"@class\", StringType(), True),\n                                        StructField(\"contentPath\", StringType(), True),\n                                        StructField(\"matchedUrlPattern\", StringType(), True),\n                                        StructField(\"siteDefinition\", StructType([\n                                            StructField(\"@class\", StringType(), True),\n                                            StructField(\"displayName\", StringType(), True),\n                                            StructField(\"filterStateConfiguration\", StringType(), True),\n                                            StructField(\"id\", StringType(), True),\n                                            StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                            StructField(\"urlPattern\", StringType(), True)\n                                        ]), True),\n                                        StructField(\"siteId\", StringType(), True),\n                                        StructField(\"validSite\", BooleanType(), True)\n                                    ]), True)\n                                ]), True\n                            ), True),\n                            StructField(\"totalNumRecs\", LongType(), True)\n                        ]), True\n                    ), True),\n                    StructField(\"endeca:auditInfo\", StructType([\n                        StructField(\"ecr:innerPath\", StringType(), True),\n                        StructField(\"ecr:resourcePath\", StringType(), True)\n                    ]), True),\n                    StructField(\"externo\", BooleanType(), True),\n                    StructField(\"imageURL\", StringType(), True),\n                    StructField(\"modal\", BooleanType(), True),\n                    StructField(\"name\", StringType(), True),\n                    StructField(\"ruleLimit\", StringType(), True),\n                    StructField(\"templateIds\", ArrayType(StringType(), True), True),\n                    StructField(\"templateTypes\", ArrayType(StringType(), True), True),\n                    StructField(\"urlRedirect\", StringType(), True)\n                ]), True\n            ), True),\n            StructField(\"descriptionSEO\", StringType(), True),\n            StructField(\"endeca:auditInfo\", StructType([\n                StructField(\"ecr:innerPath\", StringType(), True),\n                StructField(\"ecr:resourcePath\", StringType(), True)\n            ]), True),\n            StructField(\"keywordsSEO\", StringType(), True),\n            StructField(\"name\", StringType(), True),\n            StructField(\"titleSEO\", StringType(), True)\n        ]), True\n    )\n\n    return cat_schema\n</code></pre>"},{"location":"reference/scraping_coto/etl/silver/schemas/departments/","title":"departments","text":""},{"location":"reference/scraping_coto/etl/silver/schemas/departments/#scraping_coto.etl.silver.schemas.departments","title":"scraping_coto.etl.silver.schemas.departments","text":""},{"location":"reference/scraping_coto/etl/silver/schemas/departments/#scraping_coto.etl.silver.schemas.departments-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/etl/silver/schemas/departments/#scraping_coto.etl.silver.schemas.departments.department_schema","title":"department_schema","text":"<pre><code>department_schema()\n</code></pre> <p>Define the schema for department data. Returns:     ArrayType: Schema for department data.</p> Source code in <code>src\\scraping_coto\\etl\\silver\\schemas\\departments.py</code> <pre><code>def department_schema():\n    \"\"\"\n        Define the schema for department data.\n        Returns:\n            ArrayType: Schema for department data.\n    \"\"\"\n\n    audit_info = StructType([\n        StructField(\"ecr:innerPath\", StringType(), True),\n        StructField(\"ecr:resourcePath\", StringType(), True),\n    ])\n\n    link_struct = StructType([\n        StructField(\"@class\", StringType(), True),\n        StructField(\"linkType\", StringType(), True),\n        StructField(\"path\", StringType(), True),\n        StructField(\"queryString\", StringType(), True),\n    ])\n\n    site_definition = StructType([\n        StructField(\"@class\", StringType(), True),\n        StructField(\"displayName\", StringType(), True),\n        StructField(\"filterStateConfiguration\", StringType(), True),\n        StructField(\"id\", StringType(), True),\n        StructField(\"patterns\", ArrayType(StringType()), True),\n        StructField(\"urlPattern\", StringType(), True),\n    ])\n\n    site_state = StructType([\n        StructField(\"@class\", StringType(), True),\n        StructField(\"contentPath\", StringType(), True),\n        StructField(\"matchedUrlPattern\", StringType(), True),\n        StructField(\"siteDefinition\", site_definition, True),\n        StructField(\"siteId\", StringType(), True),\n        StructField(\"validSite\", BooleanType(), True),\n    ])\n\n    nav_action = StructType([\n        StructField(\"@class\", StringType(), True),\n        StructField(\"contentPath\", StringType(), True),\n        StructField(\"label\", StringType(), True),\n        StructField(\"navigationState\", StringType(), True),\n        StructField(\"siteRootPath\", StringType(), True),\n        StructField(\"siteState\", site_state, True),\n    ])\n\n    # ----------------------------\n    # Footer sub-structures\n    # ----------------------------\n    footer_bottom_item = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"content\", StringType(), True),\n        StructField(\"endeca:auditInfo\", audit_info, True),\n        StructField(\"image_src\", StringType(), True),\n        StructField(\"linkClass\", StringType(), True),\n        StructField(\"name\", StringType(), True),\n    ])\n\n    footer_center_subitem = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"endeca:auditInfo\", audit_info, True),\n        StructField(\"isButton\", BooleanType(), True),\n        StructField(\"isIMG\", BooleanType(), True),\n        StructField(\"label\", StringType(), True),\n        StructField(\"link\", link_struct, True),\n        StructField(\"linkClass\", StringType(), True),\n        StructField(\"name\", StringType(), True),\n        StructField(\"src\", StringType(), True),\n        StructField(\"subitems\", ArrayType(StringType()), True),\n        StructField(\"typeRedirect\", StringType(), True),\n    ])\n\n    footer_center_item = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"content\", StringType(), True),\n        StructField(\"endeca:auditInfo\", audit_info, True),\n        StructField(\"image_src\", StringType(), True),\n        StructField(\"label\", StringType(), True),\n        StructField(\"link\", link_struct, True),\n        StructField(\"linkClass\", StringType(), True),\n        StructField(\"name\", StringType(), True),\n        StructField(\"subitems\", ArrayType(footer_center_subitem), True),\n    ])\n\n    footer_top_item = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"displayNamePropertyAlias\", StringType(), True),\n        StructField(\"endeca:auditInfo\", audit_info, True),\n        StructField(\"isFooter\", BooleanType(), True),\n        StructField(\"name\", StringType(), True),\n    ])\n\n    footer_contents_item = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"FooterBottom\", ArrayType(footer_bottom_item), True),\n        StructField(\"FooterCenter\", ArrayType(footer_center_item), True),\n        StructField(\"FooterTop\", ArrayType(footer_top_item), True),\n        StructField(\"endeca:auditInfo\", audit_info, True),\n        StructField(\"name\", StringType(), True),\n    ])\n\n    footer_element = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"contentPaths\", ArrayType(StringType()), True),\n        StructField(\"contents\", ArrayType(footer_contents_item), True),\n        StructField(\"endeca:auditInfo\", audit_info, True),\n        StructField(\"name\", StringType(), True),\n        StructField(\"ruleLimit\", StringType(), True),\n        StructField(\"templateIds\", ArrayType(StringType()), True),\n        StructField(\"templateTypes\", ArrayType(StringType()), True),\n    ])\n\n    # ----------------------------\n    # Header sub-structures\n    # ----------------------------\n    header_top_subitem = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"Suscription\", ArrayType(StringType()), True),\n        StructField(\"endeca:auditInfo\", audit_info, True),\n        StructField(\"label\", StringType(), True),\n        StructField(\"link\", link_struct, True),\n        StructField(\"linkClass\", StringType(), True),\n        StructField(\"name\", StringType(), True),\n        StructField(\"subitems\", ArrayType(StringType()), True),\n    ])\n\n    header_component = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"displayNamePropertyAlias\", StringType(), True),\n        StructField(\"endeca:auditInfo\", audit_info, True),\n        StructField(\"name\", StringType(), True),\n        StructField(\"image_src\", StringType(), True),\n        StructField(\"link\", link_struct, True),\n        StructField(\"linkClass\", StringType(), True),\n        StructField(\"urlImage\", StringType(), True),\n        StructField(\"subitems\", ArrayType(header_top_subitem), True),\n    ])\n\n    header_contents_block = StructType([\n        StructField(\"Bottom\", ArrayType(header_component), True),\n        StructField(\"Center\", ArrayType(header_component), True),\n        StructField(\"Mobile\", ArrayType(header_component), True),\n        StructField(\"Top\", ArrayType(header_component), True),\n    ])\n\n    header_element = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"contentPaths\", ArrayType(StringType()), True),\n        StructField(\"contents\", ArrayType(header_contents_block), True),\n        StructField(\"endeca:auditInfo\", audit_info, True),\n        StructField(\"name\", StringType(), True),\n        StructField(\"ruleLimit\", StringType(), True),\n        StructField(\"templateIds\", ArrayType(StringType()), True),\n        StructField(\"templateTypes\", ArrayType(StringType()), True),\n    ])\n\n    # ----------------------------\n    # Left (navigation) sub-structures\n    # ----------------------------\n    subcat_level2 = StructType([\n        StructField(\"categoryId\", StringType(), True),\n        StructField(\"displayName\", StringType(), True),\n        StructField(\"navigationState\", StringType(), True),\n    ])\n\n    subcat = StructType([\n        StructField(\"categoryId\", StringType(), True),\n        StructField(\"displayName\", StringType(), True),\n        StructField(\"navigationState\", StringType(), True),\n        StructField(\"subCategories2\", ArrayType(subcat_level2), True),\n    ])\n\n    top_level_category = StructType([\n        StructField(\"categoryId\", StringType(), True),\n        StructField(\"displayName\", StringType(), True),\n        StructField(\"heroImageDescription\", StringType(), True),\n        StructField(\"heroImageUrl\", StringType(), True),\n        StructField(\"navigationState\", StringType(), True),\n        StructField(\"smallImageUrl\", StringType(), True),\n    ])\n\n    category_struct = StructType([\n        StructField(\"subCategories\", ArrayType(subcat), True),\n        StructField(\"topLevelCategory\", top_level_category, True),\n    ])\n\n    # ancestor properties struct\n    ancestor_props = StructType([\n        StructField(\"DGraph.Spec\", StringType(), True),\n        StructField(\"category.ancestorCatalogIds\", StringType(), True),\n        StructField(\"category.catalogs.repositoryId\", StringType(), True),\n        StructField(\"category.repositoryId\", StringType(), True),\n        StructField(\"category.rootCatalogId\", StringType(), True),\n        StructField(\"category.siteId\", StringType(), True),\n        StructField(\"displayName_es\", StringType(), True),\n        StructField(\"record.id\", StringType(), True),\n    ])\n\n    ancestor_site_definition = StructType([\n        StructField(\"@class\", StringType(), True),\n        StructField(\"displayName\", StringType(), True),\n        StructField(\"filterStateConfiguration\", StringType(), True),\n        StructField(\"id\", StringType(), True),\n        StructField(\"patterns\", ArrayType(StringType()), True),\n        StructField(\"urlPattern\", StringType(), True),\n    ])\n\n    ancestor_site_state = StructType([\n        StructField(\"@class\", StringType(), True),\n        StructField(\"contentPath\", StringType(), True),\n        StructField(\"matchedUrlPattern\", StringType(), True),\n        StructField(\"siteDefinition\", ancestor_site_definition, True),\n        StructField(\"siteId\", StringType(), True),\n        StructField(\"validSite\", BooleanType(), True),\n    ])\n\n    ancestor_item = StructType([\n        StructField(\"@class\", StringType(), True),\n        StructField(\"contentPath\", StringType(), True),\n        StructField(\"label\", StringType(), True),\n        StructField(\"navigationState\", StringType(), True),\n        StructField(\"properties\", ancestor_props, True),\n        StructField(\"siteRootPath\", StringType(), True),\n        StructField(\"siteState\", ancestor_site_state, True),\n    ])\n\n    navigation_item = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"ancestors\", ArrayType(ancestor_item), True),\n        StructField(\"siteRootPath\", StringType(), True),\n        StructField(\"siteState\", ancestor_site_state, True),\n    ])\n\n    refinement_properties = StructType([\n        StructField(\"DGraph.Spec\", StringType(), True),\n        StructField(\"DGraph.Strata\", StringType(), True),\n        StructField(\"category.ancestorCatalogIds\", StringType(), True),\n        StructField(\"category.catalogs.repositoryId\", StringType(), True),\n        StructField(\"category.repositoryId\", StringType(), True),\n        StructField(\"category.rootCatalogId\", StringType(), True),\n        StructField(\"category.siteId\", StringType(), True),\n        StructField(\"displayName_es\", StringType(), True),\n        StructField(\"record.id\", StringType(), True),\n    ])\n\n    refinement_item = StructType([\n        StructField(\"@class\", StringType(), True),\n        StructField(\"contentPath\", StringType(), True),\n        StructField(\"count\", LongType(), True),\n        StructField(\"label\", StringType(), True),\n        StructField(\"multiSelect\", BooleanType(), True),\n        StructField(\"navigationState\", StringType(), True),\n        StructField(\"properties\", refinement_properties, True),\n        StructField(\"siteRootPath\", StringType(), True),\n        StructField(\"siteState\", ancestor_site_state, True),\n    ])\n\n    range_remove_action = StructType([\n        StructField(\"@class\", StringType(), True),\n        StructField(\"contentPath\", StringType(), True),\n        StructField(\"label\", StringType(), True),\n        StructField(\"navigationState\", StringType(), True),\n        StructField(\"siteRootPath\", StringType(), True),\n        StructField(\"siteState\", ancestor_site_state, True),\n    ])\n\n    range_filter_crumb = StructType([\n        StructField(\"@class\", StringType(), True),\n        StructField(\"label\", StringType(), True),\n        StructField(\"lowerBound\", StringType(), True),\n        StructField(\"name\", StringType(), True),\n        StructField(\"operation\", StringType(), True),\n        StructField(\"propertyName\", StringType(), True),\n        StructField(\"removeAction\", range_remove_action, True),\n        StructField(\"upperBound\", StringType(), True),\n    ])\n\n    left_content_inner = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"categories\", ArrayType(category_struct), True),\n        StructField(\"endeca:auditInfo\", audit_info, True),\n        StructField(\"name\", StringType(), True),\n        StructField(\"navigation\", ArrayType(navigation_item), True),\n        StructField(\"dimensionName\", StringType(), True),\n        StructField(\"displayName\", StringType(), True),\n        StructField(\"displayNameProperty\", StringType(), True),\n        StructField(\"displayNamePropertyAlias\", StringType(), True),\n        StructField(\"moreLink\", nav_action, True),\n        StructField(\"multiSelect\", BooleanType(), True),\n        StructField(\"refinements\", ArrayType(refinement_item), True),\n        StructField(\"whyPrecedenceRuleFired\", StringType(), True),\n    ])\n\n    left_item = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"contentPaths\", ArrayType(StringType()), True),\n        StructField(\"contents\", ArrayType(left_content_inner), True),\n        StructField(\"endeca:auditInfo\", audit_info, True),\n        StructField(\"displayNameProperty\", StringType(), True),\n        StructField(\"displayNamePropertyAlias\", StringType(), True),\n        StructField(\"geoFilterCrumb\", StringType(), True),\n        StructField(\"imageURL1\", StringType(), True),\n        StructField(\"imageURL2\", StringType(), True),\n        StructField(\"name\", StringType(), True),\n        StructField(\"rangeFilterCrumbs\", ArrayType(range_filter_crumb), True),\n        StructField(\"refinementCrumbs\", ArrayType(StringType()), True),\n        StructField(\"removeAllAction\", nav_action, True),\n        StructField(\"ruleLimit\", StringType(), True),\n        StructField(\"searchCrumbs\", ArrayType(StringType()), True),\n        StructField(\"templateIds\", ArrayType(StringType()), True),\n        StructField(\"templateTypes\", ArrayType(StringType()), True),\n        StructField(\"urlRedirect1\", StringType(), True),\n        StructField(\"urlRedirect2\", StringType(), True),\n    ])\n\n    # ----------------------------\n    # Main sub-structures (contents -&gt; records)\n    # ----------------------------\n    # inner-most attributes struct in your print (long list) - we'll include the keys shown\n    inner_attributes = StructType([\n        StructField(\"allAncestors.displayName\", ArrayType(StringType()), True),\n        StructField(\"allAncestors.repositoryId\", ArrayType(StringType()), True),\n        StructField(\"parentCategory.displayName\", ArrayType(StringType()), True),\n        StructField(\"product.CLASE\", ArrayType(StringType()), True),\n        StructField(\"product.DEPTO\", ArrayType(StringType()), True),\n        StructField(\"product.FAMILIA\", ArrayType(StringType()), True),\n        StructField(\"product.LCLASE\", ArrayType(StringType()), True),\n        StructField(\"product.LDEPAR\", ArrayType(StringType()), True),\n        StructField(\"product.MARCA\", ArrayType(StringType()), True),\n        StructField(\"product.RELEVANCIA\", ArrayType(StringType()), True),\n        StructField(\"product.SIN TACC\", ArrayType(StringType()), True),\n        StructField(\"product.TIPO\", ArrayType(StringType()), True),\n        StructField(\"product.TOTALDEVENTAS\", ArrayType(StringType()), True),\n        StructField(\"product.auxiliaryMedia\", ArrayType(StringType()), True),\n        StructField(\"product.averageCustomerRating\", ArrayType(StringType()), True),\n        StructField(\"product.baseUrl\", ArrayType(StringType()), True),\n        StructField(\"product.brand\", ArrayType(StringType()), True),\n        StructField(\"product.briefDescription\", ArrayType(StringType()), True),\n        StructField(\"product.cFormato\", ArrayType(StringType()), True),\n        StructField(\"product.cantForm\", ArrayType(StringType()), True),\n        StructField(\"product.catalogId\", ArrayType(StringType()), True),\n        StructField(\"product.category\", ArrayType(StringType()), True),\n        StructField(\"product.categoryRank\", ArrayType(StringType()), True),\n        StructField(\"product.creationDate\", ArrayType(StringType()), True),\n        StructField(\"product.dateAvailable\", ArrayType(StringType()), True),\n        StructField(\"product.daysAvailable\", ArrayType(StringType()), True),\n        StructField(\"product.description\", ArrayType(StringType()), True),\n        StructField(\"product.disallowAsRecommendation\", ArrayType(StringType()), True),\n        StructField(\"product.displayName\", ArrayType(StringType()), True),\n        StructField(\"product.dtoCaracteristicas\", ArrayType(StringType()), True),\n        StructField(\"product.dtoDescuentos\", ArrayType(StringType()), True),\n        StructField(\"product.dtoDescuentosMediosPago\", ArrayType(StringType()), True),\n        StructField(\"product.eanPrincipal\", ArrayType(StringType()), True),\n        StructField(\"product.endDate\", ArrayType(StringType()), True),\n        StructField(\"product.esPeque\", ArrayType(StringType()), True),\n        StructField(\"product.idTipoGrupo\", ArrayType(StringType()), True),\n        StructField(\"product.keywords\", ArrayType(StringType()), True),\n        StructField(\"product.language\", ArrayType(StringType()), True),\n        StructField(\"product.largeImage.url\", ArrayType(StringType()), True),\n        StructField(\"product.ldescr\", ArrayType(StringType()), True),\n        StructField(\"product.longDescription\", ArrayType(StringType()), True),\n        StructField(\"product.mediumImage.url\", ArrayType(StringType()), True),\n        StructField(\"product.nonreturnable\", ArrayType(StringType()), True),\n        StructField(\"product.priceListPair\", ArrayType(StringType()), True),\n        StructField(\"product.proveedorChico\", ArrayType(StringType()), True),\n        StructField(\"product.repositoryId\", ArrayType(StringType()), True),\n        # many sDisp_* fields as strings\n        StructField(\"product.sDisp_056\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_060\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_061\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_063\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_064\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_065\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_075\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_078\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_085\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_090\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_091\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_092\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_107\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_109\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_129\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_131\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_133\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_160\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_165\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_178\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_181\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_182\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_184\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_185\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_188\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_189\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_197\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_200\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_204\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_209\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_215\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_219\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_220\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_238\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_400\", ArrayType(StringType()), True),\n        StructField(\"product.sDisp_710\", ArrayType(StringType()), True),\n        StructField(\"product.siteId\", ArrayType(StringType()), True),\n        StructField(\"product.startDate\", ArrayType(StringType()), True),\n        StructField(\"product.tipoOferta\", ArrayType(StringType()), True),\n        StructField(\"product.unidades.descUnidad\", ArrayType(StringType()), True),\n        StructField(\"product.unidades.esPesable\", ArrayType(StringType()), True),\n        StructField(\"product.url\", ArrayType(StringType()), True),\n\n        StructField(\"record.id\", ArrayType(StringType()), True),\n        StructField(\"record.source\", ArrayType(StringType()), True),\n        StructField(\"record.type\", ArrayType(StringType()), True),\n\n        # SKU fields\n        StructField(\"sku.activePrice\", ArrayType(StringType()), True),\n        StructField(\"sku.baseUrl\", ArrayType(StringType()), True),\n        StructField(\"sku.creationDate\", ArrayType(StringType()), True),\n        StructField(\"sku.description\", ArrayType(StringType()), True),\n        StructField(\"sku.displayName\", ArrayType(StringType()), True),\n        StructField(\"sku.dtoPrice\", ArrayType(StringType()), True),\n        StructField(\"sku.endDate\", ArrayType(StringType()), True),\n        StructField(\"sku.margin\", ArrayType(StringType()), True),\n        StructField(\"sku.onSaleText\", ArrayType(StringType()), True),\n        StructField(\"sku.quantity\", ArrayType(StringType()), True),\n        StructField(\"sku.referencePrice\", ArrayType(StringType()), True),\n        StructField(\"sku.repositoryId\", ArrayType(StringType()), True),\n        StructField(\"sku.siteId\", ArrayType(StringType()), True),\n        StructField(\"sku.startDate\", ArrayType(StringType()), True),\n        StructField(\"sku.unit_of_measure\", ArrayType(StringType()), True),\n        StructField(\"sku.url\", ArrayType(StringType()), True),\n    ])\n\n    inner_record_level = StructType([\n        StructField(\"@class\", StringType(), True),\n        StructField(\"attributes\", inner_attributes, True),\n        StructField(\"detailsAction\", StructType([\n            StructField(\"@class\", StringType(), True),\n            StructField(\"contentPath\", StringType(), True),\n            StructField(\"label\", StringType(), True),\n            StructField(\"recordState\", StringType(), True),\n            StructField(\"siteRootPath\", StringType(), True),\n            StructField(\"siteState\", site_state, True),\n        ]), True),\n        StructField(\"numRecords\", LongType(), True),\n        StructField(\"records\", StringType(), True),  # schema printed shows records as string at this inner-most level\n    ])\n\n    outer_record_attributes = StructType([\n        StructField(\"product.displayName\", ArrayType(StringType()), True),\n        StructField(\"product.repositoryId\", ArrayType(StringType()), True),\n    ])\n\n    outer_record = StructType([\n        StructField(\"@class\", StringType(), True),\n        StructField(\"attributes\", outer_record_attributes, True),\n        StructField(\"detailsAction\", StructType([\n            StructField(\"@class\", StringType(), True),\n            StructField(\"contentPath\", StringType(), True),\n            StructField(\"label\", StringType(), True),\n            StructField(\"recordState\", StringType(), True),\n            StructField(\"siteRootPath\", StringType(), True),\n            StructField(\"siteState\", site_state, True),\n        ]), True),\n        StructField(\"numRecords\", LongType(), True),\n        StructField(\"records\", ArrayType(inner_record_level), True),\n    ])\n\n    content_record = StructType([\n        StructField(\"@class\", StringType(), True),\n        StructField(\"attributes\", outer_record_attributes, True),\n        StructField(\"detailsAction\", StructType([\n            StructField(\"@class\", StringType(), True),\n            StructField(\"contentPath\", StringType(), True),\n            StructField(\"label\", StringType(), True),\n            StructField(\"recordState\", StringType(), True),\n            StructField(\"siteRootPath\", StringType(), True),\n            StructField(\"siteState\", site_state, True),\n        ]), True),\n        StructField(\"numRecords\", LongType(), True),\n        StructField(\"records\", ArrayType(inner_record_level), True),\n    ])\n\n    content_struct = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"endeca:auditInfo\", audit_info, True),\n        StructField(\"firstRecNum\", LongType(), True),\n        StructField(\"json-ld\", StringType(), True),\n        StructField(\"lastRecNum\", LongType(), True),\n        StructField(\"name\", StringType(), True),\n        StructField(\"pagingActionTemplate\", StructType([\n            StructField(\"@class\", StringType(), True),\n            StructField(\"contentPath\", StringType(), True),\n            StructField(\"label\", StringType(), True),\n            StructField(\"navigationState\", StringType(), True),\n            StructField(\"siteRootPath\", StringType(), True),\n            StructField(\"siteState\", site_state, True),\n        ]), True),\n        StructField(\"precomputedSorts\", ArrayType(StringType()), True),\n        StructField(\"records\", ArrayType(outer_record), True),\n        StructField(\"recsPerPage\", LongType(), True),\n        StructField(\"sortOptions\", ArrayType(StructType([\n            StructField(\"@class\", StringType(), True),\n            StructField(\"contentPath\", StringType(), True),\n            StructField(\"label\", StringType(), True),\n            StructField(\"navigationState\", StringType(), True),\n            StructField(\"selected\", BooleanType(), True),\n            StructField(\"siteRootPath\", StringType(), True),\n            StructField(\"siteState\", site_state, True),\n        ])), True),\n        StructField(\"totalNumRecs\", LongType(), True),\n    ])\n\n    main_item = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"bannerName\", StringType(), True),\n        StructField(\"contentPaths\", ArrayType(StringType()), True),\n        StructField(\"contents\", ArrayType(content_struct), True),\n        StructField(\"endeca:auditInfo\", audit_info, True),\n        StructField(\"externo\", BooleanType(), True),\n        StructField(\"imageURL\", StringType(), True),\n        StructField(\"modal\", BooleanType(), True),\n        StructField(\"name\", StringType(), True),\n        StructField(\"ruleLimit\", StringType(), True),\n        StructField(\"templateIds\", ArrayType(StringType()), True),\n        StructField(\"templateTypes\", ArrayType(StringType()), True),\n        StructField(\"urlRedirect\", StringType(), True),\n    ])\n\n    # ----------------------------\n    # Root element struct (array&lt;struct&lt; ... &gt;&gt;)\n    # ----------------------------\n    root_struct = StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"Footer\", ArrayType(footer_element), True),\n        StructField(\"Header\", ArrayType(header_element), True),\n        StructField(\"Left\", ArrayType(left_item), True),\n        StructField(\"Main\", ArrayType(main_item), True),\n        StructField(\"descriptionSEO\", StringType(), True),\n        StructField(\"endeca:auditInfo\", audit_info, True),\n        StructField(\"keywordsSEO\", StringType(), True),\n        StructField(\"name\", StringType(), True),\n        StructField(\"titleSEO\", StringType(), True),\n    ])\n\n    schema = ArrayType(root_struct, True)\n\n    return schema\n</code></pre>"},{"location":"reference/scraping_coto/etl/silver/schemas/items/","title":"items","text":""},{"location":"reference/scraping_coto/etl/silver/schemas/items/#scraping_coto.etl.silver.schemas.items","title":"scraping_coto.etl.silver.schemas.items","text":""},{"location":"reference/scraping_coto/etl/silver/schemas/items/#scraping_coto.etl.silver.schemas.items-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/etl/silver/schemas/items/#scraping_coto.etl.silver.schemas.items.items_main_schema","title":"items_main_schema","text":"<pre><code>items_main_schema()\n</code></pre> <p>Define the schema for items data. Returns:     ArrayType: Schema for items data.</p> Source code in <code>src\\scraping_coto\\etl\\silver\\schemas\\items.py</code> <pre><code>def items_main_schema():\n    \"\"\"\n        Define the schema for items data.\n        Returns:\n            ArrayType: Schema for items data.\n    \"\"\"\n\n    items_schema = ArrayType(StructType([\n        StructField(\"@type\", StringType(), True),\n        StructField(\"Footer\", ArrayType(StructType([\n            StructField(\"@type\", StringType(), True),\n            StructField(\"contentPaths\", ArrayType(StringType(), True), True),\n            StructField(\"contents\", ArrayType(StructType([\n                StructField(\"@type\", StringType(), True),\n                StructField(\"FooterBottom\", ArrayType(StructType([\n                    StructField(\"@type\", StringType(), True),\n                    StructField(\"content\", StringType(), True),\n                    StructField(\"endeca:auditInfo\", StructType([\n                        StructField(\"ecr:innerPath\", StringType(), True),\n                        StructField(\"ecr:resourcePath\", StringType(), True)\n                    ]), True),\n                    StructField(\"image_src\", StringType(), True),\n                    StructField(\"linkClass\", StringType(), True),\n                    StructField(\"name\", StringType(), True)\n                ]), True), True),\n                StructField(\"FooterCenter\", ArrayType(StructType([\n                    StructField(\"@type\", StringType(), True),\n                    StructField(\"content\", StringType(), True),\n                    StructField(\"endeca:auditInfo\", StructType([\n                        StructField(\"ecr:innerPath\", StringType(), True),\n                        StructField(\"ecr:resourcePath\", StringType(), True)\n                    ]), True),\n                    StructField(\"image_src\", StringType(), True),\n                    StructField(\"label\", StringType(), True),\n                    StructField(\"link\", StructType([\n                        StructField(\"@class\", StringType(), True),\n                        StructField(\"linkType\", StringType(), True),\n                        StructField(\"path\", StringType(), True),\n                        StructField(\"queryString\", StringType(), True)\n                    ]), True),\n                    StructField(\"linkClass\", StringType(), True),\n                    StructField(\"name\", StringType(), True),\n                    StructField(\"subitems\", ArrayType(StructType([\n                        StructField(\"@type\", StringType(), True),\n                        StructField(\"endeca:auditInfo\", StructType([\n                            StructField(\"ecr:innerPath\", StringType(), True),\n                            StructField(\"ecr:resourcePath\", StringType(), True)\n                        ]), True),\n                        StructField(\"isButton\", BooleanType(), True),\n                        StructField(\"isIMG\", BooleanType(), True),\n                        StructField(\"label\", StringType(), True),\n                        StructField(\"link\", StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"linkType\", StringType(), True),\n                            StructField(\"path\", StringType(), True),\n                            StructField(\"queryString\", StringType(), True)\n                        ]), True),\n                        StructField(\"linkClass\", StringType(), True),\n                        StructField(\"name\", StringType(), True),\n                        StructField(\"src\", StringType(), True),\n                        StructField(\"subitems\", ArrayType(StringType(), True), True),\n                        StructField(\"typeRedirect\", StringType(), True)\n                    ]), True), True)\n                ]), True), True),\n                StructField(\"FooterTop\", ArrayType(StructType([\n                    StructField(\"@type\", StringType(), True),\n                    StructField(\"displayNamePropertyAlias\", StringType(), True),\n                    StructField(\"endeca:auditInfo\", StructType([\n                        StructField(\"ecr:innerPath\", StringType(), True),\n                        StructField(\"ecr:resourcePath\", StringType(), True)\n                    ]), True),\n                    StructField(\"isFooter\", BooleanType(), True),\n                    StructField(\"name\", StringType(), True)\n                ]), True), True),\n                StructField(\"endeca:auditInfo\", StructType([\n                    StructField(\"ecr:innerPath\", StringType(), True),\n                    StructField(\"ecr:resourcePath\", StringType(), True)\n                ]), True),\n                StructField(\"name\", StringType(), True)\n            ]), True), True),\n            StructField(\"endeca:auditInfo\", StructType([\n                StructField(\"ecr:innerPath\", StringType(), True),\n                StructField(\"ecr:resourcePath\", StringType(), True)\n            ]), True),\n            StructField(\"name\", StringType(), True),\n            StructField(\"ruleLimit\", StringType(), True),\n            StructField(\"templateIds\", ArrayType(StringType(), True), True),\n            StructField(\"templateTypes\", ArrayType(StringType(), True), True)\n        ]), True), True),\n        StructField(\"Header\", ArrayType(StructType([\n            StructField(\"@type\", StringType(), True),\n            StructField(\"contentPaths\", ArrayType(StringType(), True), True),\n            StructField(\"contents\", ArrayType(StructType([\n                StructField(\"@type\", StringType(), True),\n                StructField(\"Bottom\", ArrayType(StructType([\n                    StructField(\"@type\", StringType(), True),\n                    StructField(\"displayNamePropertyAlias\", StringType(), True),\n                    StructField(\"endeca:auditInfo\", StructType([\n                        StructField(\"ecr:innerPath\", StringType(), True),\n                        StructField(\"ecr:resourcePath\", StringType(), True)\n                    ]), True),\n                    StructField(\"name\", StringType(), True)\n                ]), True), True),\n                StructField(\"Center\", ArrayType(StructType([\n                    StructField(\"@type\", StringType(), True),\n                    StructField(\"displayNamePropertyAlias\", StringType(), True),\n                    StructField(\"endeca:auditInfo\", StructType([\n                        StructField(\"ecr:innerPath\", StringType(), True),\n                        StructField(\"ecr:resourcePath\", StringType(), True)\n                    ]), True),\n                    StructField(\"image_src\", StringType(), True),\n                    StructField(\"link\", StructType([\n                        StructField(\"@class\", StringType(), True),\n                        StructField(\"linkType\", StringType(), True),\n                        StructField(\"path\", StringType(), True),\n                        StructField(\"queryString\", StringType(), True)\n                    ]), True),\n                    StructField(\"linkClass\", StringType(), True),\n                    StructField(\"name\", StringType(), True),\n                    StructField(\"urlImage\", StringType(), True)\n                ]), True), True),\n                StructField(\"Mobile\", ArrayType(StructType([\n                    StructField(\"@type\", StringType(), True),\n                    StructField(\"displayNamePropertyAlias\", StringType(), True),\n                    StructField(\"endeca:auditInfo\", StructType([\n                        StructField(\"ecr:innerPath\", StringType(), True),\n                        StructField(\"ecr:resourcePath\", StringType(), True)\n                    ]), True),\n                    StructField(\"name\", StringType(), True)\n                ]), True), True),\n                StructField(\"Top\", ArrayType(StructType([\n                    StructField(\"@type\", StringType(), True),\n                    StructField(\"displayNamePropertyAlias\", StringType(), True),\n                    StructField(\"endeca:auditInfo\", StructType([\n                        StructField(\"ecr:innerPath\", StringType(), True),\n                        StructField(\"ecr:resourcePath\", StringType(), True)\n                    ]), True),\n                    StructField(\"name\", StringType(), True),\n                    StructField(\"subitems\", ArrayType(StructType([\n                        StructField(\"@type\", StringType(), True),\n                        StructField(\"Suscription\", ArrayType(StringType(), True), True),\n                        StructField(\"endeca:auditInfo\", StructType([\n                            StructField(\"ecr:innerPath\", StringType(), True),\n                            StructField(\"ecr:resourcePath\", StringType(), True)\n                        ]), True),\n                        StructField(\"label\", StringType(), True),\n                        StructField(\"link\", StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"linkType\", StringType(), True),\n                            StructField(\"path\", StringType(), True),\n                            StructField(\"queryString\", StringType(), True)\n                        ]), True),\n                        StructField(\"linkClass\", StringType(), True),\n                        StructField(\"name\", StringType(), True),\n                        StructField(\"subitems\", ArrayType(StringType(), True), True)\n                    ]), True), True)\n                ]), True), True),\n                StructField(\"endeca:auditInfo\", StructType([\n                    StructField(\"ecr:innerPath\", StringType(), True),\n                    StructField(\"ecr:resourcePath\", StringType(), True)\n                ]), True),\n                StructField(\"name\", StringType(), True)\n            ]), True), True),\n            StructField(\"endeca:auditInfo\", StructType([\n                StructField(\"ecr:innerPath\", StringType(), True),\n                StructField(\"ecr:resourcePath\", StringType(), True)\n            ]), True),\n            StructField(\"name\", StringType(), True),\n            StructField(\"ruleLimit\", StringType(), True),\n            StructField(\"templateIds\", ArrayType(StringType(), True), True),\n            StructField(\"templateTypes\", ArrayType(StringType(), True), True)\n        ]), True), True),\n        StructField(\"Left\", ArrayType(StructType([\n            StructField(\"@type\", StringType(), True),\n            StructField(\"contentPaths\", ArrayType(StringType(), True), True),\n            StructField(\"contents\", ArrayType(StructType([\n                StructField(\"@type\", StringType(), True),\n                StructField(\"categories\", ArrayType(StructType([\n                    StructField(\"subCategories\", ArrayType(StructType([\n                        StructField(\"categoryId\", StringType(), True),\n                        StructField(\"displayName\", StringType(), True),\n                        StructField(\"navigationState\", StringType(), True),\n                        StructField(\"subCategories2\", ArrayType(StructType([\n                            StructField(\"categoryId\", StringType(), True),\n                            StructField(\"displayName\", StringType(), True),\n                            StructField(\"navigationState\", StringType(), True)\n                        ]), True), True)\n                    ]), True), True),\n                    StructField(\"topLevelCategory\", StructType([\n                        StructField(\"categoryId\", StringType(), True),\n                        StructField(\"displayName\", StringType(), True),\n                        StructField(\"heroImageDescription\", StringType(), True),\n                        StructField(\"heroImageUrl\", StringType(), True),\n                        StructField(\"navigationState\", StringType(), True),\n                        StructField(\"smallImageUrl\", StringType(), True)\n                    ]), True)\n                ]), True), True),\n                StructField(\"endeca:auditInfo\", StructType([\n                    StructField(\"ecr:innerPath\", StringType(), True),\n                    StructField(\"ecr:resourcePath\", StringType(), True)\n                ]), True),\n                StructField(\"name\", StringType(), True),\n                StructField(\"navigation\", ArrayType(StructType([\n                    StructField(\"@type\", StringType(), True),\n                    StructField(\"ancestors\", ArrayType(StructType([\n                        StructField(\"@class\", StringType(), True),\n                        StructField(\"contentPath\", StringType(), True),\n                        StructField(\"label\", StringType(), True),\n                        StructField(\"navigationState\", StringType(), True),\n                        StructField(\"properties\", StructType([\n                            StructField(\"DGraph.More\", StringType(), True),\n                            StructField(\"DGraph.Spec\", StringType(), True),\n                            StructField(\"DGraph.Strata\", StringType(), True),\n                            StructField(\"category.ancestorCatalogIds\", StringType(), True),\n                            StructField(\"category.catalogs.repositoryId\", StringType(), True),\n                            StructField(\"category.repositoryId\", StringType(), True),\n                            StructField(\"category.rootCatalogId\", StringType(), True),\n                            StructField(\"category.siteId\", StringType(), True),\n                            StructField(\"displayName_es\", StringType(), True),\n                            StructField(\"record.id\", StringType(), True)\n                        ]), True),\n                        StructField(\"siteRootPath\", StringType(), True),\n                        StructField(\"siteState\", StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"contentPath\", StringType(), True),\n                            StructField(\"matchedUrlPattern\", StringType(), True),\n                            StructField(\"siteDefinition\", StructType([\n                                StructField(\"@class\", StringType(), True),\n                                StructField(\"displayName\", StringType(), True),\n                                StructField(\"filterStateConfiguration\", StringType(), True),\n                                StructField(\"id\", StringType(), True),\n                                StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                StructField(\"urlPattern\", StringType(), True)\n                            ]), True),\n                            StructField(\"siteId\", StringType(), True),\n                            StructField(\"validSite\", BooleanType(), True)\n                        ]), True)\n                    ]), True), True),\n                    StructField(\"dimensionName\", StringType(), True),\n                    StructField(\"displayName\", StringType(), True),\n                    StructField(\"displayNameProperty\", StringType(), True),\n                    StructField(\"displayNamePropertyAlias\", StringType(), True),\n                    StructField(\"endeca:auditInfo\", StructType([\n                        StructField(\"ecr:innerPath\", StringType(), True),\n                        StructField(\"ecr:resourcePath\", StringType(), True)\n                    ]), True),\n                    StructField(\"moreLink\", StructType([\n                        StructField(\"@class\", StringType(), True),\n                        StructField(\"contentPath\", StringType(), True),\n                        StructField(\"label\", StringType(), True),\n                        StructField(\"navigationState\", StringType(), True),\n                        StructField(\"siteRootPath\", StringType(), True),\n                        StructField(\"siteState\", StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"contentPath\", StringType(), True),\n                            StructField(\"matchedUrlPattern\", StringType(), True),\n                            StructField(\"siteDefinition\", StructType([\n                                StructField(\"@class\", StringType(), True),\n                                StructField(\"displayName\", StringType(), True),\n                                StructField(\"filterStateConfiguration\", StringType(), True),\n                                StructField(\"id\", StringType(), True),\n                                StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                StructField(\"urlPattern\", StringType(), True)\n                            ]), True),\n                            StructField(\"siteId\", StringType(), True),\n                            StructField(\"validSite\", BooleanType(), True)\n                        ]), True)\n                    ]), True),\n                    StructField(\"multiSelect\", BooleanType(), True),\n                    StructField(\"name\", StringType(), True),\n                    StructField(\"refinements\", ArrayType(StructType([\n                        StructField(\"@class\", StringType(), True),\n                        StructField(\"contentPath\", StringType(), True),\n                        StructField(\"count\", LongType(), True),\n                        StructField(\"label\", StringType(), True),\n                        StructField(\"multiSelect\", BooleanType(), True),\n                        StructField(\"navigationState\", StringType(), True),\n                        StructField(\"properties\", StructType([\n                            StructField(\"DGraph.Spec\", StringType(), True),\n                            StructField(\"DGraph.Strata\", StringType(), True),\n                            StructField(\"category.ancestorCatalogIds\", StringType(), True),\n                            StructField(\"category.catalogs.repositoryId\", StringType(), True),\n                            StructField(\"category.repositoryId\", StringType(), True),\n                            StructField(\"category.rootCatalogId\", StringType(), True),\n                            StructField(\"category.siteId\", StringType(), True),\n                            StructField(\"displayName_es\", StringType(), True),\n                            StructField(\"record.id\", StringType(), True)\n                        ]), True),\n                        StructField(\"siteRootPath\", StringType(), True),\n                        StructField(\"siteState\", StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"contentPath\", StringType(), True),\n                            StructField(\"matchedUrlPattern\", StringType(), True),\n                            StructField(\"siteDefinition\", StructType([\n                                StructField(\"@class\", StringType(), True),\n                                StructField(\"displayName\", StringType(), True),\n                                StructField(\"filterStateConfiguration\", StringType(), True),\n                                StructField(\"id\", StringType(), True),\n                                StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                StructField(\"urlPattern\", StringType(), True)\n                            ]), True),\n                            StructField(\"siteId\", StringType(), True),\n                            StructField(\"validSite\", BooleanType(), True)\n                        ]), True)\n                    ]), True), True),\n                    StructField(\"whyPrecedenceRuleFired\", StringType(), True)\n                ]), True), True)\n            ]), True), True),\n            StructField(\"displayNameProperty\", StringType(), True),\n            StructField(\"displayNamePropertyAlias\", StringType(), True),\n            StructField(\"endeca:auditInfo\", StructType([\n                StructField(\"ecr:innerPath\", StringType(), True),\n                StructField(\"ecr:resourcePath\", StringType(), True)\n            ]), True),\n            StructField(\"geoFilterCrumb\", StringType(), True),\n            StructField(\"imageURL1\", StringType(), True),\n            StructField(\"imageURL2\", StringType(), True),\n            StructField(\"name\", StringType(), True),\n            StructField(\"rangeFilterCrumbs\", ArrayType(StructType([\n                StructField(\"@class\", StringType(), True),\n                StructField(\"label\", StringType(), True),\n                StructField(\"lowerBound\", StringType(), True),\n                StructField(\"name\", StringType(), True),\n                StructField(\"operation\", StringType(), True),\n                StructField(\"propertyName\", StringType(), True),\n                StructField(\"removeAction\", StructType([\n                    StructField(\"@class\", StringType(), True),\n                    StructField(\"contentPath\", StringType(), True),\n                    StructField(\"label\", StringType(), True),\n                    StructField(\"navigationState\", StringType(), True),\n                    StructField(\"siteRootPath\", StringType(), True),\n                    StructField(\"siteState\", StructType([\n                        StructField(\"@class\", StringType(), True),\n                        StructField(\"contentPath\", StringType(), True),\n                        StructField(\"matchedUrlPattern\", StringType(), True),\n                        StructField(\"siteDefinition\", StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"displayName\", StringType(), True),\n                            StructField(\"filterStateConfiguration\", StringType(), True),\n                            StructField(\"id\", StringType(), True),\n                            StructField(\"patterns\", ArrayType(StringType(), True), True),\n                            StructField(\"urlPattern\", StringType(), True)\n                        ]), True),\n                        StructField(\"siteId\", StringType(), True),\n                        StructField(\"validSite\", BooleanType(), True)\n                    ]), True)\n                ]), True),\n                StructField(\"upperBound\", StringType(), True)\n            ]), True), True),\n            StructField(\"refinementCrumbs\", ArrayType(StructType([\n                StructField(\"@class\", StringType(), True),\n                StructField(\"ancestors\", ArrayType(StructType([\n                    StructField(\"@class\", StringType(), True),\n                    StructField(\"contentPath\", StringType(), True),\n                    StructField(\"label\", StringType(), True),\n                    StructField(\"navigationState\", StringType(), True),\n                    StructField(\"properties\", StructType([\n                        StructField(\"DGraph.Spec\", StringType(), True),\n                        StructField(\"category.ancestorCatalogIds\", StringType(), True),\n                        StructField(\"category.catalogs.repositoryId\", StringType(), True),\n                        StructField(\"category.repositoryId\", StringType(), True),\n                        StructField(\"category.rootCatalogId\", StringType(), True),\n                        StructField(\"category.siteId\", StringType(), True),\n                        StructField(\"displayName_es\", StringType(), True),\n                        StructField(\"record.id\", StringType(), True)\n                    ]), True),\n                    StructField(\"siteRootPath\", StringType(), True),\n                    StructField(\"siteState\", StructType([\n                        StructField(\"@class\", StringType(), True),\n                        StructField(\"contentPath\", StringType(), True),\n                        StructField(\"matchedUrlPattern\", StringType(), True),\n                        StructField(\"siteDefinition\", StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"displayName\", StringType(), True),\n                            StructField(\"filterStateConfiguration\", StringType(), True),\n                            StructField(\"id\", StringType(), True),\n                            StructField(\"patterns\", ArrayType(StringType(), True), True),\n                            StructField(\"urlPattern\", StringType(), True)\n                        ]), True),\n                        StructField(\"siteId\", StringType(), True),\n                        StructField(\"validSite\", BooleanType(), True)\n                    ]), True)\n                ]), True), True),\n                StructField(\"count\", LongType(), True),\n                StructField(\"dimensionName\", StringType(), True),\n                StructField(\"displayName\", StringType(), True),\n                StructField(\"label\", StringType(), True),\n                StructField(\"multiSelect\", BooleanType(), True),\n                StructField(\"properties\", StructType([\n                    StructField(\"DGraph.More\", StringType(), True),\n                    StructField(\"DGraph.Spec\", StringType(), True),\n                    StructField(\"DGraph.Strata\", StringType(), True),\n                    StructField(\"category.ancestorCatalogIds\", StringType(), True),\n                    StructField(\"category.catalogs.repositoryId\", StringType(), True),\n                    StructField(\"category.repositoryId\", StringType(), True),\n                    StructField(\"category.rootCatalogId\", StringType(), True),\n                    StructField(\"category.siteId\", StringType(), True),\n                    StructField(\"displayName_es\", StringType(), True),\n                    StructField(\"record.id\", StringType(), True)\n                ]), True),\n                StructField(\"removeAction\", StructType([\n                    StructField(\"@class\", StringType(), True),\n                    StructField(\"contentPath\", StringType(), True),\n                    StructField(\"label\", StringType(), True),\n                    StructField(\"navigationState\", StringType(), True),\n                    StructField(\"siteRootPath\", StringType(), True),\n                    StructField(\"siteState\", StructType([\n                        StructField(\"@class\", StringType(), True),\n                        StructField(\"contentPath\", StringType(), True),\n                        StructField(\"matchedUrlPattern\", StringType(), True),\n                        StructField(\"siteDefinition\", StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"displayName\", StringType(), True),\n                            StructField(\"filterStateConfiguration\", StringType(), True),\n                            StructField(\"id\", StringType(), True),\n                            StructField(\"patterns\", ArrayType(StringType(), True), True),\n                            StructField(\"urlPattern\", StringType(), True)\n                        ]), True),\n                        StructField(\"siteId\", StringType(), True),\n                        StructField(\"validSite\", BooleanType(), True)\n                    ]), True)\n                ]), True)\n            ]), True), True),\n            StructField(\"removeAllAction\", StructType([\n                StructField(\"@class\", StringType(), True),\n                StructField(\"contentPath\", StringType(), True),\n                StructField(\"label\", StringType(), True),\n                StructField(\"navigationState\", StringType(), True),\n                StructField(\"siteRootPath\", StringType(), True),\n                StructField(\"siteState\", StructType([\n                    StructField(\"@class\", StringType(), True),\n                    StructField(\"contentPath\", StringType(), True),\n                    StructField(\"matchedUrlPattern\", StringType(), True),\n                    StructField(\"siteDefinition\", StructType([\n                        StructField(\"@class\", StringType(), True),\n                        StructField(\"displayName\", StringType(), True),\n                        StructField(\"filterStateConfiguration\", StringType(), True),\n                        StructField(\"id\", StringType(), True),\n                        StructField(\"patterns\", ArrayType(StringType(), True), True),\n                        StructField(\"urlPattern\", StringType(), True)\n                    ]), True),\n                    StructField(\"siteId\", StringType(), True),\n                    StructField(\"validSite\", BooleanType(), True)\n                ]), True)\n            ]), True),\n            StructField(\"ruleLimit\", StringType(), True),\n            StructField(\"searchCrumbs\", ArrayType(StringType(), True), True),\n            StructField(\"templateIds\", ArrayType(StringType(), True), True),\n            StructField(\"templateTypes\", ArrayType(StringType(), True), True),\n            StructField(\"urlRedirect1\", StringType(), True),\n            StructField(\"urlRedirect2\", StringType(), True)\n        ]), True), True),\n        StructField(\"Main\", ArrayType(StructType([\n            StructField(\"@type\", StringType(), True),\n            StructField(\"bannerName\", StringType(), True),\n            StructField(\"contentPaths\", ArrayType(StringType(), True), True),\n            StructField(\"contents\", ArrayType(StructType([\n                StructField(\"@type\", StringType(), True),\n                StructField(\"endeca:auditInfo\", StructType([\n                    StructField(\"ecr:innerPath\", StringType(), True),\n                    StructField(\"ecr:resourcePath\", StringType(), True)\n                ]), True),\n                StructField(\"firstRecNum\", LongType(), True),\n                StructField(\"json-ld\", StringType(), True),\n                StructField(\"lastRecNum\", LongType(), True),\n                StructField(\"name\", StringType(), True),\n                StructField(\"pagingActionTemplate\", StructType([\n                    StructField(\"@class\", StringType(), True),\n                    StructField(\"contentPath\", StringType(), True),\n                    StructField(\"label\", StringType(), True),\n                    StructField(\"navigationState\", StringType(), True),\n                    StructField(\"siteRootPath\", StringType(), True),\n                    StructField(\"siteState\", StructType([\n                        StructField(\"@class\", StringType(), True),\n                        StructField(\"contentPath\", StringType(), True),\n                        StructField(\"matchedUrlPattern\", StringType(), True),\n                        StructField(\"siteDefinition\", StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"displayName\", StringType(), True),\n                            StructField(\"filterStateConfiguration\", StringType(), True),\n                            StructField(\"id\", StringType(), True),\n                            StructField(\"patterns\", ArrayType(StringType(), True), True),\n                            StructField(\"urlPattern\", StringType(), True)\n                        ]), True),\n                        StructField(\"siteId\", StringType(), True),\n                        StructField(\"validSite\", BooleanType(), True)\n                    ]), True)\n                ]), True),\n                StructField(\"precomputedSorts\", ArrayType(StringType(), True), True),\n                StructField(\"records\", ArrayType(StructType([\n                    StructField(\"@class\", StringType(), True),\n                    StructField(\"attributes\", StructType([\n                        StructField(\"product.displayName\", ArrayType(StringType(), True), True),\n                        StructField(\"product.repositoryId\", ArrayType(StringType(), True), True)\n                    ]), True),\n                    StructField(\"detailsAction\", StructType([\n                        StructField(\"@class\", StringType(), True),\n                        StructField(\"contentPath\", StringType(), True),\n                        StructField(\"label\", StringType(), True),\n                        StructField(\"recordState\", StringType(), True),\n                        StructField(\"siteRootPath\", StringType(), True),\n                        StructField(\"siteState\", StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"contentPath\", StringType(), True),\n                            StructField(\"matchedUrlPattern\", StringType(), True),\n                            StructField(\"siteDefinition\", StructType([\n                                StructField(\"@class\", StringType(), True),\n                                StructField(\"displayName\", StringType(), True),\n                                StructField(\"filterStateConfiguration\", StringType(), True),\n                                StructField(\"id\", StringType(), True),\n                                StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                StructField(\"urlPattern\", StringType(), True)\n                            ]), True),\n                            StructField(\"siteId\", StringType(), True),\n                            StructField(\"validSite\", BooleanType(), True)\n                        ]), True)\n                    ]), True),\n                    StructField(\"numRecords\", LongType(), True),\n                    StructField(\"records\", ArrayType(StructType([\n                        StructField(\"@class\", StringType(), True),\n                        StructField(\"attributes\", StructType([\n                            StructField(\"allAncestors.displayName\", ArrayType(StringType(), True), True),\n                            StructField(\"allAncestors.repositoryId\", ArrayType(StringType(), True), True),\n                            StructField(\"parentCategory.displayName\", ArrayType(StringType(), True), True),\n                            StructField(\"product.ACCIONAMIENTO AUTOMATICO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.BODEGA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.BOTELLA RETORNABLE\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CABLE RETRACTIL\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CANASTO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CANTIDAD\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CANTIDAD DE HILOS\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CAPACIDAD\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CAPACIDAD DE CARGA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CAPACIDAD DE LAVADO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CAPACIDAD DE MOLIENDA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CAPACIDAD MAXIMA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CAPAS DE CONFORT\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CATEGORIA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CLASE\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CLIMATIZACION\", ArrayType(StringType(), True), True),\n                            StructField(\"product.COLOR\", ArrayType(StringType(), True), True),\n                            StructField(\"product.COMPOSICI\u00d3N DE TELA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.COMPOSICI\u00d3N TELA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CONECTIVIDAD\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CONTENIDO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CONTROL DE TEMPERATURA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CORTE AUTOMATICO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.CUADRO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.DEPTO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.DISPLAY DIGITAL\", ArrayType(StringType(), True), True),\n                            StructField(\"product.DI\u00c1METRO DE LLANTA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.DURACI\u00d3N ESTIMADA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.EDAD\", ArrayType(StringType(), True), True),\n                            StructField(\"product.ELABORACI\u00d3N\", ArrayType(StringType(), True), True),\n                            StructField(\"product.ENVASADO AL VAC\u00cdO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.ENVASE\", ArrayType(StringType(), True), True),\n                            StructField(\"product.EQUIVALENTE A\", ArrayType(StringType(), True), True),\n                            StructField(\"product.ESTILO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.ESTRUCTURA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.ESTUCHE\", ArrayType(StringType(), True), True),\n                            StructField(\"product.ETAPA DE VIDA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.FAMILIA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.FORMA DE CALENTAMIENTO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.FORMATO DE USO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.FRAGANCIAS\", ArrayType(StringType(), True), True),\n                            StructField(\"product.FRIGORIAS\", ArrayType(StringType(), True), True),\n                            StructField(\"product.FUNCION MANTENER CALOR\", ArrayType(StringType(), True), True),\n                            StructField(\"product.GARANTIA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.GRAMAJE\", ArrayType(StringType(), True), True),\n                            StructField(\"product.G\u00c9NERO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.HORQUILLA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.IBU\", ArrayType(StringType(), True), True),\n                            StructField(\"product.INTERNA-EXTERNA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.KOSHER\", ArrayType(StringType(), True), True),\n                            StructField(\"product.LCLASE\", ArrayType(StringType(), True), True),\n                            StructField(\"product.LDEPAR\", ArrayType(StringType(), True), True),\n                            StructField(\"product.LUZ INDICADOR DE COCCION\", ArrayType(StringType(), True), True),\n                            StructField(\"product.MARCA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.MATERIAL DE CUCHILLAS\", ArrayType(StringType(), True), True),\n                            StructField(\"product.MATERIAL DE PLACAS\", ArrayType(StringType(), True), True),\n                            StructField(\"product.MEDIDA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.MODELO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.MODELO DE L\u00c1MPARA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.MODELO DE ROSCA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.MODO DEPILACION\", ArrayType(StringType(), True), True),\n                            StructField(\"product.MOTOR\", ArrayType(StringType(), True), True),\n                            StructField(\"product.NIVEL DE FIRMEZA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.NOMBRE\", ArrayType(StringType(), True), True),\n                            StructField(\"product.ORIGEN\", ArrayType(StringType(), True), True),\n                            StructField(\"product.ORIGEN DE LA MARCA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.PAIS\", ArrayType(StringType(), True), True),\n                            StructField(\"product.PANEL DIGITAL\", ArrayType(StringType(), True), True),\n                            StructField(\"product.PESO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.PILLOW\", ArrayType(StringType(), True), True),\n                            StructField(\"product.POSICIONADOR\", ArrayType(StringType(), True), True),\n                            StructField(\"product.POTENCIA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.POTENCIA (WATS)\", ArrayType(StringType(), True), True),\n                            StructField(\"product.PRECISION\", ArrayType(StringType(), True), True),\n                            StructField(\"product.PRENSATELAS\", ArrayType(StringType(), True), True),\n                            StructField(\"product.PRESI\u00d3N\", ArrayType(StringType(), True), True),\n                            StructField(\"product.PROVINCIA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.PULGADAS\", ArrayType(StringType(), True), True),\n                            StructField(\"product.RANGO DE VELOCIDAD\", ArrayType(StringType(), True), True),\n                            StructField(\"product.REGION\", ArrayType(StringType(), True), True),\n                            StructField(\"product.RELEVANCIA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.RESOLUCION\", ArrayType(StringType(), True), True),\n                            StructField(\"product.RODADO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.SABOR\", ArrayType(StringType(), True), True),\n                            StructField(\"product.SALIDA AL EXTERIOR\", ArrayType(StringType(), True), True),\n                            StructField(\"product.SELECTOR DE TEMPERATURA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.SIN TACC\", ArrayType(StringType(), True), True),\n                            StructField(\"product.SISTEMA DE FUNCIONAMIENTO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.SMART\", ArrayType(StringType(), True), True),\n                            StructField(\"product.SUBMARCA-L\u00cdNEA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.SUSPENSION\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TALLE\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TAMA\u00d1O\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TAMA\u00d1O DE LA RAZA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TARA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TECNOLOGIA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TEMPORIZADOR\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIMER\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIMER PROGRAMABLE\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE AGUJA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE ALIMENTACION\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE ALIMENTO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE ASPIRADORA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE BALANZA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE BICICLETA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE CARGA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE CARNE\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE CERVEZA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE CORTE\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE EMPAQUE\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE EQUIPO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE FRENOS\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE LUZ\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE L\u00c1MPARA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE MATERIAL\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE MEMORIA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE PRODUCTO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE S\u00c1BANA\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIPO DE VACUNO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TIRAJE\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TOTALDEVENTAS\", ArrayType(StringType(), True), True),\n                            StructField(\"product.TRABAJA EN FRIO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.ULTRA SILENCIOSO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.UVA-CEPAJE\", ArrayType(StringType(), True), True),\n                            StructField(\"product.VARIETAL\", ArrayType(StringType(), True), True),\n                            StructField(\"product.VELOCIDAD DE CENTRIFUGADO\", ArrayType(StringType(), True), True),\n                            StructField(\"product.VELOCIDADES\", ArrayType(StringType(), True), True),\n                            StructField(\"product.VERSION CPU\", ArrayType(StringType(), True), True),\n                            StructField(\"product.VOLUMEN\", ArrayType(StringType(), True), True),\n                            StructField(\"product.adescr\", ArrayType(StringType(), True), True),\n                            StructField(\"product.auxiliaryMedia\", ArrayType(StringType(), True), True),\n                            StructField(\"product.averageCustomerRating\", ArrayType(StringType(), True), True),\n                            StructField(\"product.baseUrl\", ArrayType(StringType(), True), True),\n                            StructField(\"product.brand\", ArrayType(StringType(), True), True),\n                            StructField(\"product.briefDescription\", ArrayType(StringType(), True), True),\n                            StructField(\"product.cFormato\", ArrayType(StringType(), True), True),\n                            StructField(\"product.cantForm\", ArrayType(StringType(), True), True),\n                            StructField(\"product.cantidadMinima\", ArrayType(StringType(), True), True),\n                            StructField(\"product.catalogId\", ArrayType(StringType(), True), True),\n                            StructField(\"product.category\", ArrayType(StringType(), True), True),\n                            StructField(\"product.categoryRank\", ArrayType(StringType(), True), True),\n                            StructField(\"product.creationDate\", ArrayType(StringType(), True), True),\n                            StructField(\"product.dateAvailable\", ArrayType(StringType(), True), True),\n                            StructField(\"product.daysAvailable\", ArrayType(StringType(), True), True),\n                            StructField(\"product.description\", ArrayType(StringType(), True), True),\n                            StructField(\"product.disallowAsRecommendation\", ArrayType(StringType(), True), True),\n                            StructField(\"product.displayName\", ArrayType(StringType(), True), True),\n                            StructField(\"product.dtoCaracteristicas\", ArrayType(StringType(), True), True),\n                            StructField(\"product.dtoDescuentos\", ArrayType(StringType(), True), True),\n                            StructField(\"product.dtoDescuentosMediosPago\", ArrayType(StringType(), True), True),\n                            StructField(\"product.eanPrincipal\", ArrayType(StringType(), True), True),\n                            StructField(\"product.endDate\", ArrayType(StringType(), True), True),\n                            StructField(\"product.esPeque\", ArrayType(StringType(), True), True),\n                            StructField(\"product.idTipoGrupo\", ArrayType(StringType(), True), True),\n                            StructField(\"product.keywords\", ArrayType(StringType(), True), True),\n                            StructField(\"product.language\", ArrayType(StringType(), True), True),\n                            StructField(\"product.largeImage.url\", ArrayType(StringType(), True), True),\n                            StructField(\"product.ldescr\", ArrayType(StringType(), True), True),\n                            StructField(\"product.longDescription\", ArrayType(StringType(), True), True),\n                            StructField(\"product.mediumImage.url\", ArrayType(StringType(), True), True),\n                            StructField(\"product.nonreturnable\", ArrayType(StringType(), True), True),\n                            StructField(\"product.priceListPair\", ArrayType(StringType(), True), True),\n                            StructField(\"product.proveedorChico\", ArrayType(StringType(), True), True),\n                            StructField(\"product.repositoryId\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_056\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_060\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_061\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_063\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_064\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_065\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_075\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_078\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_085\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_090\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_091\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_092\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_107\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_109\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_129\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_131\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_133\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_160\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_165\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_178\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_181\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_182\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_184\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_185\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_188\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_189\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_197\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_200\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_204\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_209\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_215\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_219\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_220\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_238\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_400\", ArrayType(StringType(), True), True),\n                            StructField(\"product.sDisp_710\", ArrayType(StringType(), True), True),\n                            StructField(\"product.saltoCantidad\", ArrayType(StringType(), True), True),\n                            StructField(\"product.siteId\", ArrayType(StringType(), True), True),\n                            StructField(\"product.startDate\", ArrayType(StringType(), True), True),\n                            StructField(\"product.tipoOferta\", ArrayType(StringType(), True), True),\n                            StructField(\"product.unidades.descUnidad\", ArrayType(StringType(), True), True),\n                            StructField(\"product.unidades.esPesable\", ArrayType(StringType(), True), True),\n                            StructField(\"product.url\", ArrayType(StringType(), True), True),\n                            StructField(\"record.id\", ArrayType(StringType(), True), True),\n                            StructField(\"record.source\", ArrayType(StringType(), True), True),\n                            StructField(\"record.type\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.activePrice\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.baseUrl\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.creationDate\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.description\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.displayName\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.dtoPrice\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.endDate\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.margin\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.onSaleText\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.quantity\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.referencePrice\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.repositoryId\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.siteId\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.startDate\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.unit_of_measure\", ArrayType(StringType(), True), True),\n                            StructField(\"sku.url\", ArrayType(StringType(), True), True)\n                        ]), True),\n                        StructField(\"detailsAction\", StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"contentPath\", StringType(), True),\n                            StructField(\"label\", StringType(), True),\n                            StructField(\"recordState\", StringType(), True),\n                            StructField(\"siteRootPath\", StringType(), True),\n                            StructField(\"siteState\", StructType([\n                                StructField(\"@class\", StringType(), True),\n                                StructField(\"contentPath\", StringType(), True),\n                                StructField(\"matchedUrlPattern\", StringType(), True),\n                                StructField(\"siteDefinition\", StructType([\n                                    StructField(\"@class\", StringType(), True),\n                                    StructField(\"displayName\", StringType(), True),\n                                    StructField(\"filterStateConfiguration\", StringType(), True),\n                                    StructField(\"id\", StringType(), True),\n                                    StructField(\"patterns\", ArrayType(StringType(), True), True),\n                                    StructField(\"urlPattern\", StringType(), True)\n                                ]), True),\n                                StructField(\"siteId\", StringType(), True),\n                                StructField(\"validSite\", BooleanType(), True)\n                            ]), True)\n                        ]), True)\n                    ]), True), True)\n                ]), True), True),\n                StructField(\"recsPerPage\", LongType(), True),\n                StructField(\"sortOptions\", ArrayType(StructType([\n                    StructField(\"@class\", StringType(), True),\n                    StructField(\"contentPath\", StringType(), True),\n                    StructField(\"label\", StringType(), True),\n                    StructField(\"navigationState\", StringType(), True),\n                    StructField(\"selected\", BooleanType(), True),\n                    StructField(\"siteRootPath\", StringType(), True),\n                    StructField(\"siteState\", StructType([\n                        StructField(\"@class\", StringType(), True),\n                        StructField(\"contentPath\", StringType(), True),\n                        StructField(\"matchedUrlPattern\", StringType(), True),\n                        StructField(\"siteDefinition\", StructType([\n                            StructField(\"@class\", StringType(), True),\n                            StructField(\"displayName\", StringType(), True),\n                            StructField(\"filterStateConfiguration\", StringType(), True),\n                            StructField(\"id\", StringType(), True),\n                            StructField(\"patterns\", ArrayType(StringType(), True), True),\n                            StructField(\"urlPattern\", StringType(), True)\n                        ]), True),\n                        StructField(\"siteId\", StringType(), True),\n                        StructField(\"validSite\", BooleanType(), True)\n                    ]), True)\n                ]), True), True),\n                StructField(\"totalNumRecs\", LongType(), True)\n            ]), True), True),\n            StructField(\"endeca:auditInfo\", StructType([\n                StructField(\"ecr:innerPath\", StringType(), True),\n                StructField(\"ecr:resourcePath\", StringType(), True)\n            ]), True),\n            StructField(\"externo\", BooleanType(), True),\n            StructField(\"imageURL\", StringType(), True),\n            StructField(\"modal\", BooleanType(), True),\n            StructField(\"name\", StringType(), True),\n            StructField(\"ruleLimit\", StringType(), True),\n            StructField(\"templateIds\", ArrayType(StringType(), True), True),\n            StructField(\"templateTypes\", ArrayType(StringType(), True), True),\n            StructField(\"urlRedirect\", StringType(), True)\n        ]), True), True),\n        StructField(\"descriptionSEO\", StringType(), True),\n        StructField(\"endeca:auditInfo\", StructType([\n            StructField(\"ecr:innerPath\", StringType(), True),\n            StructField(\"ecr:resourcePath\", StringType(), True)\n        ]), True),\n        StructField(\"keywordsSEO\", StringType(), True),\n        StructField(\"name\", StringType(), True),\n        StructField(\"titleSEO\", StringType(), True)\n    ]))\n\n    return items_schema\n</code></pre>"},{"location":"reference/scraping_coto/etl/silver/schemas/items/#scraping_coto.etl.silver.schemas.items.items_site_schema","title":"items_site_schema","text":"<pre><code>items_site_schema()\n</code></pre> <p>Define the schema for item site state data. Returns:     StructType: Schema for item site state data.</p> Source code in <code>src\\scraping_coto\\etl\\silver\\schemas\\items.py</code> <pre><code>def items_site_schema():\n    \"\"\"\n        Define the schema for item site state data.\n        Returns:\n            StructType: Schema for item site state data.\n    \"\"\" \n\n    site_state_schema = StructType([\n        StructField(\"@class\", StringType(), True),\n        StructField(\"contentPath\", StringType(), True),\n        StructField(\"matchedUrlPattern\", StringType(), True),\n        StructField(\"siteDefinition\", StructType([\n            StructField(\"@class\", StringType(), True),\n            StructField(\"displayName\", StringType(), True),\n            StructField(\"filterStateConfiguration\", StringType(), True),\n            StructField(\"id\", StringType(), True),\n            StructField(\"patterns\", ArrayType(StringType(), True), True),\n            StructField(\"urlPattern\", StringType(), True)\n        ]), True),\n        StructField(\"siteId\", StringType(), True),\n        StructField(\"validSite\", BooleanType(), True)\n    ])\n\n    return site_state_schema\n</code></pre>"},{"location":"reference/scraping_coto/etl/silver/transformations/categories/","title":"categories","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/categories/#scraping_coto.etl.silver.transformations.categories","title":"scraping_coto.etl.silver.transformations.categories","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/categories/#scraping_coto.etl.silver.transformations.categories-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/departments/","title":"departments","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/departments/#scraping_coto.etl.silver.transformations.departments","title":"scraping_coto.etl.silver.transformations.departments","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/departments/#scraping_coto.etl.silver.transformations.departments-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/items/","title":"items","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/items/#scraping_coto.etl.silver.transformations.items","title":"scraping_coto.etl.silver.transformations.items","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/items/#scraping_coto.etl.silver.transformations.items-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/subcategories/","title":"subcategories","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/subcategories/#scraping_coto.etl.silver.transformations.subcategories","title":"scraping_coto.etl.silver.transformations.subcategories","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/subcategories/#scraping_coto.etl.silver.transformations.subcategories-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/utils/converters/","title":"converters","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/utils/converters/#scraping_coto.etl.silver.transformations.utils.converters","title":"scraping_coto.etl.silver.transformations.utils.converters","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/utils/converters/#scraping_coto.etl.silver.transformations.utils.converters-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/etl/silver/transformations/utils/converters/#scraping_coto.etl.silver.transformations.utils.converters.from_unixtime_to_timestamp","title":"from_unixtime_to_timestamp","text":"<pre><code>from_unixtime_to_timestamp(column, timezone: str = 'America/Sao_Paulo')\n</code></pre> <p>Returns a timestamp column from a unixtime column based on a timezone. Args:     column: Column to be converted.     timezone: Timezone to be used. Default is 'America/Sao_Paulo'. Returns:     Timestamp column.</p> Source code in <code>src\\scraping_coto\\etl\\silver\\transformations\\utils\\converters.py</code> <pre><code>def from_unixtime_to_timestamp(column, timezone: str = 'America/Sao_Paulo'):\n    '''\n        Returns a timestamp column from a unixtime column based on a timezone.\n        Args:\n            column: Column to be converted.\n            timezone: Timezone to be used. Default is 'America/Sao_Paulo'.\n        Returns:\n            Timestamp column.\n    '''\n\n    logger.info(f\"Converting unixtime column {column} to timestamp with timezone: {timezone}\")\n\n    if isinstance(column, str):\n        column = col(column).cast('bigint')\n    else:\n        column = column.cast('bigint')\n\n    return (\n          when(\n            column &lt; 1e10, \n            from_utc_timestamp(from_unixtime(column), timezone)\n          )\n          .when(\n            column &lt; 1e13,\n            from_utc_timestamp(from_unixtime(column / 1000), timezone)\n          )\n          .when(\n            column &lt; 1e16,\n            from_utc_timestamp(from_unixtime(column / 1_000_000), timezone)\n          )\n          .otherwise(\n            from_utc_timestamp(from_unixtime(column / 1_000_000_000), timezone)\n          )\n    )\n</code></pre>"},{"location":"reference/scraping_coto/etl/staging/extract_urls/","title":"extract_urls","text":""},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls","title":"scraping_coto.etl.staging.extract_urls","text":""},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls-classes","title":"Classes","text":""},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls.CotoScraper","title":"CotoScraper  <code>dataclass</code>","text":"<p>Scraper class to extract URLs and related data from the Coto groceries website. Args:     self: Instance of the CotoScraper class. Returns:     None Methods:     - get_general_urls: Retrieve general data from the main page of the Coto website.     - parse_base_json: Parse the JSON response to extract department, category, and subcategory information along with URLs.</p> Source code in <code>src\\scraping_coto\\etl\\staging\\extract_urls.py</code> <pre><code>@dataclass\nclass CotoScraper:\n    \"\"\"\n        Scraper class to extract URLs and related data from the Coto groceries website.\n        Args:\n            self: Instance of the CotoScraper class.\n        Returns:\n            None\n        Methods:\n            - get_general_urls: Retrieve general data from the main page of the Coto website.\n            - parse_base_json: Parse the JSON response to extract department, category, and subcategory information along with URLs.\n    \"\"\"\n\n    url = 'https://api.cotodigital.com.ar/sitios/cdigi/categoria?&amp;format=json&amp;pushSite=CotoDigital'\n    url_template = 'https://api.cotodigital.com.ar/sitios/cdigi/'\n    url_params = {'general':'categoria?&amp;format=json&amp;pushSite=CotoDigital', 'items':'{category_path}?_No={page_number}&amp;Nrpp={number_per_page}&amp;format=json&amp;pushSite=CotoDigital'}\n    ua = UserAgent()\n    user_agents = ua.get_random_user_agent()\n    headers = {'user-agent': user_agents.strip(), 'encoding':'utf-8'}\n    default_tz=pytz.timezone(\"America/Sao_Paulo\")\n\n    def get_general_urls(self):\n        '''\n            Return general data from the main page of groceries website Coto, like categories and subcategories domains.\n\n            Args:\n                self: Instance of the CotoScraper class.\n\n            Returns:\n                dict: A dictionary containing the JSON response from the website along with URL, URL parameters, timestamp, and headers.\n        '''\n\n        try:\n            logger.info(f'Starting requests for url {self.url}!')\n            r = requests.get(url = self.url, headers = self.headers)\n            json_response = json.loads(r.text)\n\n            json_response.update(\n                {\n                    \"url\": self.url_template,\n                    \"url_params\": self.url_params,\n                    \"timestamp\": str(datetime.datetime.now(tz=self.default_tz)),\n                    \"timezone\": self.default_tz.zone,\n                    \"headers\": self.headers\n                }\n            )\n            logger.info(f'Success loading data from url {self.url}!')\n            return json_response\n        except Exception as e:\n            logger.info(f'Error loading data from url {self.url}!\\n{e}')\n            return f'Erro: {e}'\n\n    def parse_base_json(self):\n        '''\n            Parse the JSON response to extract department, category, and subcategory information along with URLs.\n\n            Args:\n                self: Instance of the CotoScraperTotalItems class.\n\n            Returns:\n                list: A list of dictionaries containing department, category, subcategory details, and URLs.\n        '''\n        logger.info(f'Starting parsing department json file')\n\n        df = self.get_general_urls()\n\n        data = [\n            {\n                \"department_id\": row['topLevelCategory'].get('categoryId', ''),\n                \"department_name\": row['topLevelCategory'].get('displayName', ''),\n                \"department_url\": row['topLevelCategory'].get('navigationState', ''),\n                \"category_id\": cat.get('categoryId', ''),\n                \"category_name\": cat.get('displayName', ''),\n                \"category_url\": cat.get('navigationState', ''),\n                \"subcategory_id\": subcat.get('categoryId', ''),\n                \"subcategory_name\": subcat.get('displayName', ''),\n                \"subcategory_url\": subcat.get('navigationState', ''),\n                \"url\": df['url'],\n                \"url_params\": df['url_params'],\n                \"headers\": df['headers'],\n                \"timestamp\": df['timestamp'],\n                \"timezone\": df['timezone']\n            }\n            for row in df['contents'][0]['Left'][1]['contents'][0]['categories']\n            for cat in row.get('subCategories', [])\n            for subcat in cat.get('subCategories2', [])\n        ]\n\n        logger.info(f'Success parsing {len(data)} collections from department json file!')\n        return data\n</code></pre>"},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls.CotoScraper-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls.CotoScraper.get_general_urls","title":"get_general_urls","text":"<pre><code>get_general_urls()\n</code></pre> <p>Return general data from the main page of groceries website Coto, like categories and subcategories domains.</p> <p>Parameters:</p> Name Type Description Default <code>self</code> <p>Instance of the CotoScraper class.</p> required <p>Returns:</p> Name Type Description <code>dict</code> <p>A dictionary containing the JSON response from the website along with URL, URL parameters, timestamp, and headers.</p> Source code in <code>src\\scraping_coto\\etl\\staging\\extract_urls.py</code> <pre><code>def get_general_urls(self):\n    '''\n        Return general data from the main page of groceries website Coto, like categories and subcategories domains.\n\n        Args:\n            self: Instance of the CotoScraper class.\n\n        Returns:\n            dict: A dictionary containing the JSON response from the website along with URL, URL parameters, timestamp, and headers.\n    '''\n\n    try:\n        logger.info(f'Starting requests for url {self.url}!')\n        r = requests.get(url = self.url, headers = self.headers)\n        json_response = json.loads(r.text)\n\n        json_response.update(\n            {\n                \"url\": self.url_template,\n                \"url_params\": self.url_params,\n                \"timestamp\": str(datetime.datetime.now(tz=self.default_tz)),\n                \"timezone\": self.default_tz.zone,\n                \"headers\": self.headers\n            }\n        )\n        logger.info(f'Success loading data from url {self.url}!')\n        return json_response\n    except Exception as e:\n        logger.info(f'Error loading data from url {self.url}!\\n{e}')\n        return f'Erro: {e}'\n</code></pre>"},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls.CotoScraper.parse_base_json","title":"parse_base_json","text":"<pre><code>parse_base_json()\n</code></pre> <p>Parse the JSON response to extract department, category, and subcategory information along with URLs.</p> <p>Parameters:</p> Name Type Description Default <code>self</code> <p>Instance of the CotoScraperTotalItems class.</p> required <p>Returns:</p> Name Type Description <code>list</code> <p>A list of dictionaries containing department, category, subcategory details, and URLs.</p> Source code in <code>src\\scraping_coto\\etl\\staging\\extract_urls.py</code> <pre><code>def parse_base_json(self):\n    '''\n        Parse the JSON response to extract department, category, and subcategory information along with URLs.\n\n        Args:\n            self: Instance of the CotoScraperTotalItems class.\n\n        Returns:\n            list: A list of dictionaries containing department, category, subcategory details, and URLs.\n    '''\n    logger.info(f'Starting parsing department json file')\n\n    df = self.get_general_urls()\n\n    data = [\n        {\n            \"department_id\": row['topLevelCategory'].get('categoryId', ''),\n            \"department_name\": row['topLevelCategory'].get('displayName', ''),\n            \"department_url\": row['topLevelCategory'].get('navigationState', ''),\n            \"category_id\": cat.get('categoryId', ''),\n            \"category_name\": cat.get('displayName', ''),\n            \"category_url\": cat.get('navigationState', ''),\n            \"subcategory_id\": subcat.get('categoryId', ''),\n            \"subcategory_name\": subcat.get('displayName', ''),\n            \"subcategory_url\": subcat.get('navigationState', ''),\n            \"url\": df['url'],\n            \"url_params\": df['url_params'],\n            \"headers\": df['headers'],\n            \"timestamp\": df['timestamp'],\n            \"timezone\": df['timezone']\n        }\n        for row in df['contents'][0]['Left'][1]['contents'][0]['categories']\n        for cat in row.get('subCategories', [])\n        for subcat in cat.get('subCategories2', [])\n    ]\n\n    logger.info(f'Success parsing {len(data)} collections from department json file!')\n    return data\n</code></pre>"},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls.CotoScraperTotalItems","title":"CotoScraperTotalItems  <code>dataclass</code>","text":"<p>               Bases: <code>CotoScraper</code></p> <p>Scraper class to extract total items from departments, categories, and subcategories from the Coto groceries website. Inherits from CotoScraper. Args:     self: Instance of the CotoScraperTotalItems class. Returns:     None Methods:     - get_total_items: Retrieve total number of items for each department, category, or subcategory.     - parse_item_json: Parse the JSON response to extract the total number of items for each department, category, or subcategory.     - __get_page_async_info: Helper method to retrieve website data asynchronously from a given URL.</p> Source code in <code>src\\scraping_coto\\etl\\staging\\extract_urls.py</code> <pre><code>@dataclass\nclass CotoScraperTotalItems(CotoScraper):\n    \"\"\" \n        Scraper class to extract total items from departments, categories, and subcategories from the Coto groceries website.\n        Inherits from CotoScraper.\n        Args:\n            self: Instance of the CotoScraperTotalItems class.\n        Returns:\n            None\n        Methods:\n            - get_total_items: Retrieve total number of items for each department, category, or subcategory.\n            - parse_item_json: Parse the JSON response to extract the total number of items for each department, category, or subcategory.\n            - __get_page_async_info: Helper method to retrieve website data asynchronously from a given URL.\n    \"\"\"\n\n    async def __get_page_async_info(self, session: aiohttp.ClientSession, id: str, name: str, url: str, prefix: URLTYPE) -&gt; dict:\n        '''\n            Helper method to retrieve website data asynchronously from a given URL.\n            Args:\n                session (aiohttp.ClientSession): Active aiohttp session.\n                id (str): Identifier for the department/category/subcategory.\n                name (str): Name of the department/category/subcategory.\n                url (str): URL associated with the department/category/subcategory.\n                prefix (URLTYPE): Prefix indicating the type (department, category, or subcategory).\n            Returns:\n                dict: A dictionary containing the JSON response along with metadata.\n            Example:\n                &gt;&gt;&gt; async with aiohttp.ClientSession(headers = self.headers) as session:\n                &gt;&gt;&gt;     result = await self.__get_page_async_info(session, id=\"123\", name=\"Beverages\", url=\"beverages\", prefix=\"category\")\n        '''\n\n        extend_url = f\"https://api.cotodigital.com.ar/sitios/cdigi/{url}?&amp;format=json&amp;pushSite=CotoDigital\"\n\n        logger.info(f'Starting requests for url {url}!')\n        try:\n            async with session.get(extend_url) as response:\n\n                # Para pegar casos em que o path muda\n                results = json.loads(await response.text())\n\n                results.update(\n                    {\n                        f'{prefix}_id': id,\n                        f'{prefix}_name': name,\n                        f'{prefix}_url': url,\n                        f'{prefix}_extended_url': extend_url,\n                        'timestamp': str(datetime.datetime.now(tz=self.default_tz)),\n                        'timezone': self.default_tz.zone,\n                        'status_code': response.status\n                    }\n                )\n\n                logger.info(f'Sucesses loading data from url {url} with status code {response.status}!')\n\n        except Exception as e:\n                try:\n                    status_code = response.status\n                except:\n                    status_code = 404\n\n                logger.error(f'Error loading data from url {url} with status code {status_code}!\\n{e}')\n\n                results = {\n                    f'{prefix}_id': id,\n                    f'{prefix}_name': name,\n                    f'{prefix}_url': url,\n                    f'{prefix}_extended_url': extend_url,\n                    'timestamp': str(datetime.datetime.now(tz=self.default_tz)),\n                    'timezone': self.default_tz.zone,\n                    'status_code': status_code\n                }\n\n        return results\n\n\n    async def get_total_items(self, prefix: URLTYPE = 'department') -&gt; (list[dict] | str):\n        '''\n            Return the total number of items in a given prefix filtering from the parsed JSON data with all departments, categories and subcategories.\n\n            Args:\n                prefix: department, category or subcategory\n\n            Returns:\n                list[dict]: A list of dictionaries containing the id, name, url, extended url, number of items, and other metadata.\n                str: Error message in case of failure.\n            Example:\n                &gt;&gt;&gt; data = await CotoScraperTotalItems().get_total_items(prefix='category')\n        '''\n\n        logger.info(f'Starting processing total items from {prefix}!')\n\n        try:\n            df = self.parse_base_json()\n            url_data = pl.DataFrame(df).select(cs.starts_with(f'{prefix}')).unique().to_dicts()\n\n            results = []\n            async with aiohttp.ClientSession(headers = self.headers) as session:\n                tasks = [\n                    self.__get_page_async_info(session = session, id = row[f'{prefix}_id'], name = row[f'{prefix}_name'], url = row[f'{prefix}_url'], prefix = prefix)\n                    for row in url_data\n                ]\n                html_pages = await asyncio.gather(*tasks)\n                results.extend(html_pages)\n\n            # logger.info(f'Success processing {len(results)} items from {prefix}!')\n\n            return results\n        except Exception as e:\n            logger.error(f'Error loading total items for {prefix}!\\n{e}')\n            return f'Erro: {e}'\n\n\n    async def parse_item_json(self, prefix: URLTYPE = 'department') -&gt; list[dict]:\n        '''\n            Parse the JSON response to extract the total number of items for each department, category, or subcategory.\n\n            Args:\n                prefix: department, category or subcategory\n\n            Returns:\n                list: A list of dictionaries containing the id, name, url, extended url, number of items, and other metadata.\n\n            Example:\n                &gt;&gt;&gt; data = await CotoScraperTotalItems().parse_item_json(prefix='subcategory')\n        '''\n\n        logger.info(f'Starting parsing {prefix} json!')\n\n        data = await self.get_total_items(prefix=prefix)\n\n        results = []\n\n        for row in data:\n            try:\n                index = [idx for idx, row in enumerate(row['contents'][0]['Main']) if 'contents' in row.keys()][0]\n                items = row['contents'][0]['Main'][index]['contents'][0]['totalNumRecs']\n\n                item =  {\n                    f'{prefix}_id': row[f'{prefix}_id'],\n                    f'{prefix}_name': row[f'{prefix}_name'],\n                    f'{prefix}_url': row[f'{prefix}_url'],\n                    f'{prefix}_extended_url': row[f'{prefix}_extended_url'],\n                    f\"{prefix}_items\": items,\n                    f\"{prefix}_no\": 0,\n                    f\"{prefix}_nrpp\": items,\n                    f\"{prefix}_final_url\": [f\"https://api.cotodigital.com.ar/sitios/cdigi/{row[f'{prefix}_url']}?_No={i}&amp;Nrpp=999&amp;format=json\" for i in range(0, items, 999)],\n                    \"timestamp\": row['timestamp'],\n                    \"timezone\": row['timezone'],\n                    \"status_code\": row['status_code']\n                }\n\n                logger.info(f'[{prefix}] - sucess processing item {row[f\"{prefix}_name\"]} with status code {row[\"status_code\"]}')\n                results.append(item)\n\n            except Exception as e:\n                logger.error(f'[{prefix}] - error processing item!\\n{e}')\n\n                item =  {\n                    f'{prefix}_id': row[f'{prefix}_id'],\n                    f'{prefix}_name': row[f'{prefix}_name'],\n                    f'{prefix}_url': row[f'{prefix}_url'],\n                    f'{prefix}_extended_url': row[f'{prefix}_extended_url'],\n                    f\"{prefix}_items\": None,\n                    f\"{prefix}_no\": 0,\n                    f\"{prefix}_nrpp\": None,\n                    f\"{prefix}_final_url\": None,\n                    \"timestamp\": row['timestamp'],\n                    \"timezone\": row['timezone'],\n                    \"status_code\": row['status_code']\n                }\n\n                results.append(item)\n\n        logger.info(f'Finish processing {len(results)} collections from {prefix}!')\n        return results\n</code></pre>"},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls.CotoScraperTotalItems-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls.CotoScraperTotalItems.__get_page_async_info","title":"__get_page_async_info  <code>async</code>","text":"<pre><code>__get_page_async_info(session: ClientSession, id: str, name: str, url: str, prefix: URLTYPE) -&gt; dict\n</code></pre> <p>Helper method to retrieve website data asynchronously from a given URL. Args:     session (aiohttp.ClientSession): Active aiohttp session.     id (str): Identifier for the department/category/subcategory.     name (str): Name of the department/category/subcategory.     url (str): URL associated with the department/category/subcategory.     prefix (URLTYPE): Prefix indicating the type (department, category, or subcategory). Returns:     dict: A dictionary containing the JSON response along with metadata. Example:     &gt;&gt;&gt; async with aiohttp.ClientSession(headers = self.headers) as session:     &gt;&gt;&gt;     result = await self.__get_page_async_info(session, id=\"123\", name=\"Beverages\", url=\"beverages\", prefix=\"category\")</p> Source code in <code>src\\scraping_coto\\etl\\staging\\extract_urls.py</code> <pre><code>async def __get_page_async_info(self, session: aiohttp.ClientSession, id: str, name: str, url: str, prefix: URLTYPE) -&gt; dict:\n    '''\n        Helper method to retrieve website data asynchronously from a given URL.\n        Args:\n            session (aiohttp.ClientSession): Active aiohttp session.\n            id (str): Identifier for the department/category/subcategory.\n            name (str): Name of the department/category/subcategory.\n            url (str): URL associated with the department/category/subcategory.\n            prefix (URLTYPE): Prefix indicating the type (department, category, or subcategory).\n        Returns:\n            dict: A dictionary containing the JSON response along with metadata.\n        Example:\n            &gt;&gt;&gt; async with aiohttp.ClientSession(headers = self.headers) as session:\n            &gt;&gt;&gt;     result = await self.__get_page_async_info(session, id=\"123\", name=\"Beverages\", url=\"beverages\", prefix=\"category\")\n    '''\n\n    extend_url = f\"https://api.cotodigital.com.ar/sitios/cdigi/{url}?&amp;format=json&amp;pushSite=CotoDigital\"\n\n    logger.info(f'Starting requests for url {url}!')\n    try:\n        async with session.get(extend_url) as response:\n\n            # Para pegar casos em que o path muda\n            results = json.loads(await response.text())\n\n            results.update(\n                {\n                    f'{prefix}_id': id,\n                    f'{prefix}_name': name,\n                    f'{prefix}_url': url,\n                    f'{prefix}_extended_url': extend_url,\n                    'timestamp': str(datetime.datetime.now(tz=self.default_tz)),\n                    'timezone': self.default_tz.zone,\n                    'status_code': response.status\n                }\n            )\n\n            logger.info(f'Sucesses loading data from url {url} with status code {response.status}!')\n\n    except Exception as e:\n            try:\n                status_code = response.status\n            except:\n                status_code = 404\n\n            logger.error(f'Error loading data from url {url} with status code {status_code}!\\n{e}')\n\n            results = {\n                f'{prefix}_id': id,\n                f'{prefix}_name': name,\n                f'{prefix}_url': url,\n                f'{prefix}_extended_url': extend_url,\n                'timestamp': str(datetime.datetime.now(tz=self.default_tz)),\n                'timezone': self.default_tz.zone,\n                'status_code': status_code\n            }\n\n    return results\n</code></pre>"},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls.CotoScraperTotalItems.get_total_items","title":"get_total_items  <code>async</code>","text":"<pre><code>get_total_items(prefix: URLTYPE = 'department') -&gt; list[dict] | str\n</code></pre> <p>Return the total number of items in a given prefix filtering from the parsed JSON data with all departments, categories and subcategories.</p> <p>Parameters:</p> Name Type Description Default <code>prefix</code> <code>URLTYPE</code> <p>department, category or subcategory</p> <code>'department'</code> <p>Returns:</p> Name Type Description <code>list[dict] | str</code> <p>list[dict]: A list of dictionaries containing the id, name, url, extended url, number of items, and other metadata.</p> <code>str</code> <code>list[dict] | str</code> <p>Error message in case of failure.</p> <p>Example:     &gt;&gt;&gt; data = await CotoScraperTotalItems().get_total_items(prefix='category')</p> Source code in <code>src\\scraping_coto\\etl\\staging\\extract_urls.py</code> <pre><code>async def get_total_items(self, prefix: URLTYPE = 'department') -&gt; (list[dict] | str):\n    '''\n        Return the total number of items in a given prefix filtering from the parsed JSON data with all departments, categories and subcategories.\n\n        Args:\n            prefix: department, category or subcategory\n\n        Returns:\n            list[dict]: A list of dictionaries containing the id, name, url, extended url, number of items, and other metadata.\n            str: Error message in case of failure.\n        Example:\n            &gt;&gt;&gt; data = await CotoScraperTotalItems().get_total_items(prefix='category')\n    '''\n\n    logger.info(f'Starting processing total items from {prefix}!')\n\n    try:\n        df = self.parse_base_json()\n        url_data = pl.DataFrame(df).select(cs.starts_with(f'{prefix}')).unique().to_dicts()\n\n        results = []\n        async with aiohttp.ClientSession(headers = self.headers) as session:\n            tasks = [\n                self.__get_page_async_info(session = session, id = row[f'{prefix}_id'], name = row[f'{prefix}_name'], url = row[f'{prefix}_url'], prefix = prefix)\n                for row in url_data\n            ]\n            html_pages = await asyncio.gather(*tasks)\n            results.extend(html_pages)\n\n        # logger.info(f'Success processing {len(results)} items from {prefix}!')\n\n        return results\n    except Exception as e:\n        logger.error(f'Error loading total items for {prefix}!\\n{e}')\n        return f'Erro: {e}'\n</code></pre>"},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls.CotoScraperTotalItems.parse_item_json","title":"parse_item_json  <code>async</code>","text":"<pre><code>parse_item_json(prefix: URLTYPE = 'department') -&gt; list[dict]\n</code></pre> <p>Parse the JSON response to extract the total number of items for each department, category, or subcategory.</p> <p>Parameters:</p> Name Type Description Default <code>prefix</code> <code>URLTYPE</code> <p>department, category or subcategory</p> <code>'department'</code> <p>Returns:</p> Name Type Description <code>list</code> <code>list[dict]</code> <p>A list of dictionaries containing the id, name, url, extended url, number of items, and other metadata.</p> Example <p>data = await CotoScraperTotalItems().parse_item_json(prefix='subcategory')</p> Source code in <code>src\\scraping_coto\\etl\\staging\\extract_urls.py</code> <pre><code>async def parse_item_json(self, prefix: URLTYPE = 'department') -&gt; list[dict]:\n    '''\n        Parse the JSON response to extract the total number of items for each department, category, or subcategory.\n\n        Args:\n            prefix: department, category or subcategory\n\n        Returns:\n            list: A list of dictionaries containing the id, name, url, extended url, number of items, and other metadata.\n\n        Example:\n            &gt;&gt;&gt; data = await CotoScraperTotalItems().parse_item_json(prefix='subcategory')\n    '''\n\n    logger.info(f'Starting parsing {prefix} json!')\n\n    data = await self.get_total_items(prefix=prefix)\n\n    results = []\n\n    for row in data:\n        try:\n            index = [idx for idx, row in enumerate(row['contents'][0]['Main']) if 'contents' in row.keys()][0]\n            items = row['contents'][0]['Main'][index]['contents'][0]['totalNumRecs']\n\n            item =  {\n                f'{prefix}_id': row[f'{prefix}_id'],\n                f'{prefix}_name': row[f'{prefix}_name'],\n                f'{prefix}_url': row[f'{prefix}_url'],\n                f'{prefix}_extended_url': row[f'{prefix}_extended_url'],\n                f\"{prefix}_items\": items,\n                f\"{prefix}_no\": 0,\n                f\"{prefix}_nrpp\": items,\n                f\"{prefix}_final_url\": [f\"https://api.cotodigital.com.ar/sitios/cdigi/{row[f'{prefix}_url']}?_No={i}&amp;Nrpp=999&amp;format=json\" for i in range(0, items, 999)],\n                \"timestamp\": row['timestamp'],\n                \"timezone\": row['timezone'],\n                \"status_code\": row['status_code']\n            }\n\n            logger.info(f'[{prefix}] - sucess processing item {row[f\"{prefix}_name\"]} with status code {row[\"status_code\"]}')\n            results.append(item)\n\n        except Exception as e:\n            logger.error(f'[{prefix}] - error processing item!\\n{e}')\n\n            item =  {\n                f'{prefix}_id': row[f'{prefix}_id'],\n                f'{prefix}_name': row[f'{prefix}_name'],\n                f'{prefix}_url': row[f'{prefix}_url'],\n                f'{prefix}_extended_url': row[f'{prefix}_extended_url'],\n                f\"{prefix}_items\": None,\n                f\"{prefix}_no\": 0,\n                f\"{prefix}_nrpp\": None,\n                f\"{prefix}_final_url\": None,\n                \"timestamp\": row['timestamp'],\n                \"timezone\": row['timezone'],\n                \"status_code\": row['status_code']\n            }\n\n            results.append(item)\n\n    logger.info(f'Finish processing {len(results)} collections from {prefix}!')\n    return results\n</code></pre>"},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls.CotoScraperItems","title":"CotoScraperItems  <code>dataclass</code>","text":"<p>               Bases: <code>CotoScraperTotalItems</code></p> <p>Scraper class to extract detailed information from each item in subcategories from the Coto groceries website. Inherits from CotoScraperTotalItems. Args:     self: Instance of the CotoScraperItems class. Returns:     None Methods:     - __get_item_async_info: Helper method to retrieve item data asynchronously from a given URL.     - get_items_info: Retrieve detailed information for each item in the subcategories.</p> Source code in <code>src\\scraping_coto\\etl\\staging\\extract_urls.py</code> <pre><code>class CotoScraperItems(CotoScraperTotalItems):\n    \"\"\" \n        Scraper class to extract detailed information from each item in subcategories from the Coto groceries website.\n        Inherits from CotoScraperTotalItems.\n        Args:\n            self: Instance of the CotoScraperItems class.\n        Returns:\n            None\n        Methods:\n            - __get_item_async_info: Helper method to retrieve item data asynchronously from a given URL.\n            - get_items_info: Retrieve detailed information for each item in the subcategories.\n    \"\"\"\n    async def __get_item_async_info(self, session: aiohttp.ClientSession, id: str, url: str):\n        \"\"\" \n            Helper method to retrieve item data asynchronously from a given URL.\n            Args:\n                session (aiohttp.ClientSession): The aiohttp client session to use for the request.\n                id (str): The identifier for the item.\n                url (str): The URL to fetch the item data from.\n            Returns:\n                dict: The JSON response containing the item data, along with metadata.\n            Example:\n                &gt;&gt;&gt; async with aiohttp.ClientSession(headers = self.headers) as session:\n                &gt;&gt;&gt;     result = await self.__get_item_async_info(session, id=\"123\", url=\"subcategory/123?_No=0&amp;Nrpp=999&amp;format=json\")\n        \"\"\"\n\n        try:\n            async with session.get(url) as response:\n\n                logger.info(f'[{id}] - Getting data from {url}!')\n\n                results = json.loads(await response.text())\n\n                results.update(\n                    {\n                        'id': id,\n                        'url': url,\n                        'timestamp': str(datetime.datetime.now(tz=self.default_tz)),\n                        'timezone': self.default_tz.zone,\n                        'status_code': response.status\n                    }\n                )\n\n                logger.info(f'[{id}] - Data loaded from {url} with status code {response.status}!')\n\n        except Exception as e:\n                try:\n                    status_code = response.status\n                except:\n                    status_code = 404\n\n                logger.error(f'[{id}] - Error getting data from {url}, status code {status_code}!\\n{e}')\n\n                results = {\n                    'id': id,\n                    'url': url,\n                    'timestamp': str(datetime.datetime.now(tz=self.default_tz)),\n                    'timezone': self.default_tz.zone,\n                    'status_code': status_code\n                }\n\n        return results\n\n    async def get_items_info(self):\n        \"\"\" \n            Retrieve detailed information for each item in the subcategories.\n            Args:\n                self: Instance of the CotoScraperItems class.\n            Returns:\n                list: A list of dictionaries containing detailed information for each item.\n            Raises:\n                Exception: If there is an error during the data retrieval process.\n            Example:\n                &gt;&gt;&gt; data = await CotoScraperItems().get_items_info()\n        \"\"\"\n\n        try:\n            logger.info(f'Starting async information extraction from items!')\n            data = await self.parse_item_json(prefix='subcategory')\n            adjusted_data = [\n                {\n                    'id': item['subcategory_id'], \n                    'urls': [url for url in item['subcategory_final_url']]\n                }\n                for item in data\n                if all(\n                    [\n                        item['subcategory_final_url'] != None, \n                        item['subcategory_final_url'] != []\n                    ]\n                )\n            ]\n\n            results = []\n            async with aiohttp.ClientSession(headers = self.headers) as session:\n                tasks = [\n                    self.__get_item_async_info(session = session, id = row['id'], url = url)\n                    for row in adjusted_data\n                    for url in row['urls']\n                ]\n                response = await asyncio.gather(*tasks)\n                results.extend(response)\n\n            logger.info(f'Succesfully loaded informations from {len(results)} items!')\n\n            return results\n        except Exception as e:\n            logger.error(f'Error when tried to load information from items!\\n{e}')\n            return f'Erro: {e}'\n</code></pre>"},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls.CotoScraperItems-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls.CotoScraperItems.__get_item_async_info","title":"__get_item_async_info  <code>async</code>","text":"<pre><code>__get_item_async_info(session: ClientSession, id: str, url: str)\n</code></pre> <p>Helper method to retrieve item data asynchronously from a given URL. Args:     session (aiohttp.ClientSession): The aiohttp client session to use for the request.     id (str): The identifier for the item.     url (str): The URL to fetch the item data from. Returns:     dict: The JSON response containing the item data, along with metadata. Example:     &gt;&gt;&gt; async with aiohttp.ClientSession(headers = self.headers) as session:     &gt;&gt;&gt;     result = await self.__get_item_async_info(session, id=\"123\", url=\"subcategory/123?_No=0&amp;Nrpp=999&amp;format=json\")</p> Source code in <code>src\\scraping_coto\\etl\\staging\\extract_urls.py</code> <pre><code>async def __get_item_async_info(self, session: aiohttp.ClientSession, id: str, url: str):\n    \"\"\" \n        Helper method to retrieve item data asynchronously from a given URL.\n        Args:\n            session (aiohttp.ClientSession): The aiohttp client session to use for the request.\n            id (str): The identifier for the item.\n            url (str): The URL to fetch the item data from.\n        Returns:\n            dict: The JSON response containing the item data, along with metadata.\n        Example:\n            &gt;&gt;&gt; async with aiohttp.ClientSession(headers = self.headers) as session:\n            &gt;&gt;&gt;     result = await self.__get_item_async_info(session, id=\"123\", url=\"subcategory/123?_No=0&amp;Nrpp=999&amp;format=json\")\n    \"\"\"\n\n    try:\n        async with session.get(url) as response:\n\n            logger.info(f'[{id}] - Getting data from {url}!')\n\n            results = json.loads(await response.text())\n\n            results.update(\n                {\n                    'id': id,\n                    'url': url,\n                    'timestamp': str(datetime.datetime.now(tz=self.default_tz)),\n                    'timezone': self.default_tz.zone,\n                    'status_code': response.status\n                }\n            )\n\n            logger.info(f'[{id}] - Data loaded from {url} with status code {response.status}!')\n\n    except Exception as e:\n            try:\n                status_code = response.status\n            except:\n                status_code = 404\n\n            logger.error(f'[{id}] - Error getting data from {url}, status code {status_code}!\\n{e}')\n\n            results = {\n                'id': id,\n                'url': url,\n                'timestamp': str(datetime.datetime.now(tz=self.default_tz)),\n                'timezone': self.default_tz.zone,\n                'status_code': status_code\n            }\n\n    return results\n</code></pre>"},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls.CotoScraperItems.get_items_info","title":"get_items_info  <code>async</code>","text":"<pre><code>get_items_info()\n</code></pre> <p>Retrieve detailed information for each item in the subcategories. Args:     self: Instance of the CotoScraperItems class. Returns:     list: A list of dictionaries containing detailed information for each item. Raises:     Exception: If there is an error during the data retrieval process. Example:     &gt;&gt;&gt; data = await CotoScraperItems().get_items_info()</p> Source code in <code>src\\scraping_coto\\etl\\staging\\extract_urls.py</code> <pre><code>async def get_items_info(self):\n    \"\"\" \n        Retrieve detailed information for each item in the subcategories.\n        Args:\n            self: Instance of the CotoScraperItems class.\n        Returns:\n            list: A list of dictionaries containing detailed information for each item.\n        Raises:\n            Exception: If there is an error during the data retrieval process.\n        Example:\n            &gt;&gt;&gt; data = await CotoScraperItems().get_items_info()\n    \"\"\"\n\n    try:\n        logger.info(f'Starting async information extraction from items!')\n        data = await self.parse_item_json(prefix='subcategory')\n        adjusted_data = [\n            {\n                'id': item['subcategory_id'], \n                'urls': [url for url in item['subcategory_final_url']]\n            }\n            for item in data\n            if all(\n                [\n                    item['subcategory_final_url'] != None, \n                    item['subcategory_final_url'] != []\n                ]\n            )\n        ]\n\n        results = []\n        async with aiohttp.ClientSession(headers = self.headers) as session:\n            tasks = [\n                self.__get_item_async_info(session = session, id = row['id'], url = url)\n                for row in adjusted_data\n                for url in row['urls']\n            ]\n            response = await asyncio.gather(*tasks)\n            results.extend(response)\n\n        logger.info(f'Succesfully loaded informations from {len(results)} items!')\n\n        return results\n    except Exception as e:\n        logger.error(f'Error when tried to load information from items!\\n{e}')\n        return f'Erro: {e}'\n</code></pre>"},{"location":"reference/scraping_coto/etl/staging/extract_urls/#scraping_coto.etl.staging.extract_urls-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/utils/dbutils/","title":"dbutils","text":""},{"location":"reference/scraping_coto/utils/dbutils/#scraping_coto.utils.dbutils","title":"scraping_coto.utils.dbutils","text":""},{"location":"reference/scraping_coto/utils/dbutils/#scraping_coto.utils.dbutils-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/utils/json/","title":"json","text":""},{"location":"reference/scraping_coto/utils/json/#scraping_coto.utils.json","title":"scraping_coto.utils.json","text":""},{"location":"reference/scraping_coto/utils/json/#scraping_coto.utils.json-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/utils/json/#scraping_coto.utils.json.loader","title":"loader","text":"<pre><code>loader(file: json = None, file_path: str = None, file_name: str = None, mode: JSONMODE = 'w')\n</code></pre> <p>Function to load json files</p> <p>Parameters:</p> Name Type Description Default <code>file</code> <code>json</code> <p>json object</p> <code>None</code> <code>file_path</code> <code>str</code> <p>path to save the json file</p> <code>None</code> <code>file_name</code> <code>str</code> <p>name of the json file</p> <code>None</code> <code>mode</code> <code>JSONMODE</code> <p>file mode, default is 'w' (write)</p> <code>'w'</code> <p>Returns:</p> Name Type Description <code>str</code> <p>success message or error message</p> Source code in <code>src\\scraping_coto\\utils\\json.py</code> <pre><code>def loader(file: json = None, file_path: str = None, file_name: str = None, mode: JSONMODE = 'w'):\n    '''\n        Function to load json files\n\n        Args:\n            file: json object\n            file_path: path to save the json file\n            file_name: name of the json file\n            mode: file mode, default is 'w' (write)\n\n        Returns:\n            str: success message or error message\n    '''\n\n    dt_str = str(datetime.datetime.now(tz=pytz.timezone('America/Sao_Paulo')).date())\n    file_path = file_path if file_path else './'\n    file_name = file_name if file_name else 'data'\n    file_path_final = f'{file_path}/{dt_str}_{file_name}.json'\n\n    logger.info(f'Starting json loader to {file_path_final}!')\n\n    try:\n        with open(file_path_final, mode) as f:\n            try:\n                f.write(data)\n            except:\n                data = json.dumps(obj=file, ensure_ascii=False, indent=4)\n                f.write(data)\n\n            logger.info(f'Finished json loader to {file_path_final}!')\n\n    except Exception as e:\n        logger.info(f'Error loading json to {file_path_final}!')\n        raise Exception(f'Error: {e}')\n</code></pre>"},{"location":"reference/scraping_coto/utils/json/#scraping_coto.utils.json.reader","title":"reader","text":"<pre><code>reader(file_folder: str = None, read_mode: READMODE = 'last date', folder_type: FOLDERTYPE = 'departments')\n</code></pre> <p>Function to read json files</p> <p>Parameters:</p> Name Type Description Default <code>file_folder</code> <code>str</code> <p>path to read the json files</p> <code>None</code> <code>read_mode</code> <code>READMODE</code> <p>read mode, default is 'last date'</p> <code>'last date'</code> <p>Returns:</p> Name Type Description <code>json</code> <p>json object or error message</p> Source code in <code>src\\scraping_coto\\utils\\json.py</code> <pre><code>def reader(file_folder: str = None, read_mode: READMODE = 'last date', folder_type: FOLDERTYPE = 'departments'):\n    '''\n        Function to read json files\n\n        Args:\n            file_folder: path to read the json files\n            read_mode: read mode, default is 'last date'\n\n        Returns:\n            json: json object or error message\n    '''\n\n    DATE_REGEX = r'[0-9]{4}-[0-9]{2}-[0-9]{2}'\n    list_files = os.listdir(file_folder) if file_folder else os.listdir('./')\n    last_date = [re.compile(DATE_REGEX).match(file) for file in list_files]\n    last_date.sort(reverse=True)\n\n    try:\n        if read_mode == 'last date':\n            file_path = f'{file_folder}/{last_date[0]}_{folder_type}.json'\n\n            with open(file_path, 'r') as f:\n                data = json.load(f)\n\n        else:\n            data = []\n            for file in list_files:\n                with open(f'{file_folder}/{file}', 'r') as f:\n                    data.append(json.load(f))\n\n        return data\n\n    except Exception as e:\n        return f'Error: {e}'\n</code></pre>"},{"location":"reference/scraping_coto/utils/literals/","title":"literals","text":""},{"location":"reference/scraping_coto/utils/literals/#scraping_coto.utils.literals","title":"scraping_coto.utils.literals","text":""},{"location":"reference/scraping_coto/utils/logger/","title":"logger","text":""},{"location":"reference/scraping_coto/utils/logger/#scraping_coto.utils.logger","title":"scraping_coto.utils.logger","text":""},{"location":"reference/scraping_coto/utils/logger/#scraping_coto.utils.logger-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/utils/logger/#scraping_coto.utils.logger.get_logger","title":"get_logger","text":"<pre><code>get_logger(name: str = __name__, level: Literal['debug', 'info', 'warning', 'error', 'critical'] = 'info') -&gt; logging.Logger\n</code></pre> <p>Retorna um logger configurado para terminal e logfire com n\u00edvel e formato especificados.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Nome do logger. Default \u00e9 name.</p> <code>__name__</code> <code>level</code> <code>str</code> <p>N\u00edvel do logger, com os valores poss\u00edveis \"debug\", \"info\", \"warning\", \"error\", \"critical\". Default \u00e9 \"info\".</p> <code>'info'</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>caso o n\u00edvel de log n\u00e3o seja v\u00e1lido.</p> <p>Returns:</p> Type Description <code>Logger</code> <p>logging.Logger: Logger configurado com o n\u00edvel e formato especificados.</p> Source code in <code>src\\scraping_coto\\utils\\logger.py</code> <pre><code>def get_logger(name: str = __name__, level: Literal[\"debug\",\"info\",\"warning\",\"error\",\"critical\"] = \"info\") -&gt; logging.Logger:\n    \"\"\"Retorna um logger configurado para terminal e logfire com n\u00edvel e formato especificados.\n\n    Args:\n        name (str, optional): Nome do logger. Default \u00e9 __name__.\n        level (str, optional): N\u00edvel do logger, com os valores poss\u00edveis \"debug\", \"info\", \"warning\", \"error\", \"critical\". Default \u00e9 \"info\".\n\n    Raises:\n        ValueError: caso o n\u00edvel de log n\u00e3o seja v\u00e1lido.\n\n    Returns:\n        logging.Logger: Logger configurado com o n\u00edvel e formato especificados.\n    \"\"\"\n\n    logfire.configure(\n        # token=os.environ['BUNDLE_VAR_LOGFIRE_TOKEN'],\n        token=token,\n        # config_dir=\"~/scraping_coto\",\n        # pydantic_plugin=logfire.PydanticPlugin(record='all'), # dados de valida\u00e7\u00e3o do pydantic - Deprecado\n        console = False # Evita printar no console, j\u00e1 que para isso temos o StreamHandler\n    )\n    # logfire.instrument_pydantic()\n    logfire.instrument_requests()\n    logfire.instrument_system_metrics()\n\n    # Mapeamento de n\u00edveis de log\n    level_map = {\n        \"debug\": logging.DEBUG,\n        \"info\": logging.INFO,\n        \"warning\": logging.WARNING,\n        \"error\": logging.ERROR,\n        \"critical\": logging.CRITICAL\n    }\n\n    # Limpa a string e tenta converter\n    level_clean = level.strip().lower()\n    try:\n        log_level = level_map[level_clean]\n    except KeyError:\n        raise ValueError(\n            f\"N\u00edvel de log inv\u00e1lido: '{level}'. Use um dos valores: {list(level_map.keys())}\"\n        )\n\n    # Limpa e converte o n\u00edvel informado\n    level_clean = level.strip().lower()\n    log_level = level_map.get(level_clean, logging.INFO)  # default = INFO\n\n    # Diret\u00f3rio do projeto e dos logs\n    current_script_path = os.path.abspath(__file__)\n    app_directory = os.path.dirname(os.path.dirname(current_script_path))\n    log_dir = os.path.join(app_directory, 'logs')\n    os.makedirs(log_dir, exist_ok=True)\n\n    log_file_path = os.path.join(log_dir, 'app.log')\n\n    logger = logging.getLogger(name)\n    logger.setLevel(log_level)\n\n    if not logger.handlers:\n        formatter = logging.Formatter(\n            '[%(asctime)s] - %(levelname)s - %(funcName)s - %(message)s',\n            datefmt='%Y-%m-%d %H:%M:%S'\n        )\n\n        # LOGGER PODE TER V\u00c1RIOS HANDLERS, QUE S\u00c3O OS RESPONS\u00c1VEIS POR ENVIAR AS MENSAGENS PARA O DESTINO\n        #   * StreamHandler: Envia mensagens para o console (terminal)\n        #   * FileHandler: Envia mensagens para um arquivo\n        #   * SMTPHandler: Envia mensagens por e-mail\n        #   * HTTPHandler: Envia mensagens para um servidor HTTP\n        #   * SysLogHandler: Envia mensagens para um servidor SysLog\n        #   * NTEventLogHandler: Envia mensagens para o log de eventos do Windows\n        #   * LogfireLoggingHandler: Envia mensagens para o Logfire\n\n        # Terminal\n        stream_handler = logging.StreamHandler()\n        stream_handler.setFormatter(formatter)\n        stream_handler.setLevel(log_level)\n        logger.addHandler(stream_handler)\n\n        # Logfire\n        logfire_handler = logfire.LogfireLoggingHandler()\n        logger.addHandler(logfire_handler)\n\n        # Arquivo com rota\u00e7\u00e3o - Limita o tamanho do arquivo a 1MB e mant\u00e9m 5 backups\n        # file_handler = RotatingFileHandler(\n        #     log_file_path,\n        #     maxBytes=1_000_000,\n        #     backupCount=5,\n        #     encoding='utf-8'\n        # )\n        # file_handler.setFormatter(formatter)\n        # file_handler.setLevel(log_level)\n        # logger.addHandler(file_handler)\n\n    return logger\n</code></pre>"},{"location":"reference/scraping_coto/utils/retry/","title":"retry","text":""},{"location":"reference/scraping_coto/utils/retry/#scraping_coto.utils.retry","title":"scraping_coto.utils.retry","text":""},{"location":"reference/scraping_coto/utils/retry/#scraping_coto.utils.retry-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/utils/retry/#scraping_coto.utils.retry.retry","title":"retry","text":"<pre><code>retry(func, retries=3, delay=1)\n</code></pre> <p>Retry decorator to retry a function call a specified number of times.</p> <p>Parameters:</p> Name Type Description Default <code>func</code> <code>callable</code> <p>The function to be retried.</p> required <code>retries</code> <code>int</code> <p>The number of times to retry the function. Default is 3.</p> <code>3</code> <code>delay</code> <code>int</code> <p>The delay between retries in seconds. Default is 1.</p> <code>1</code> <p>Returns:     callable: The wrapped function that will retry on failure.</p> Source code in <code>src\\scraping_coto\\utils\\retry.py</code> <pre><code>def retry(func, retries=3, delay=1):\n    \"\"\"\n    Retry decorator to retry a function call a specified number of times.\n\n    Args:\n        func (callable): The function to be retried.\n        retries (int): The number of times to retry the function. Default is 3.\n        delay (int): The delay between retries in seconds. Default is 1.\n    Returns:\n        callable: The wrapped function that will retry on failure.\n    \"\"\"\n\n    @wraps(func)\n    def wrapper(*args, **kwargs):\n        for attempt in range(retries):\n            try:\n                return func(*args, **kwargs)\n            except Exception as e:\n                if attempt &lt; retries - 1:\n                    time.sleep(delay)\n                else:\n                    raise e\n\n    return wrapper\n</code></pre>"},{"location":"reference/scraping_coto/utils/spark_session/","title":"spark_session","text":""},{"location":"reference/scraping_coto/utils/spark_session/#scraping_coto.utils.spark_session","title":"scraping_coto.utils.spark_session","text":""},{"location":"reference/scraping_coto/utils/spark_session/#scraping_coto.utils.spark_session-functions","title":"Functions","text":""},{"location":"reference/scraping_coto/utils/spark_session/#scraping_coto.utils.spark_session.get_spark","title":"get_spark","text":"<pre><code>get_spark() -&gt; SparkSession\n</code></pre> <p>Create a new Databricks Connect session.</p> Source code in <code>src\\scraping_coto\\utils\\spark_session.py</code> <pre><code>def get_spark() -&gt; SparkSession:\n    \"\"\"\n        Create a new Databricks Connect session.\n    \"\"\"\n\n    try:\n        # session = SparkSession.getActiveSession()\n        from databricks.connect import DatabricksSession\n        return DatabricksSession.builder.getOrCreate()\n\n    except ImportError:\n        return SparkSession.builder.getOrCreate()\n</code></pre>"}]}